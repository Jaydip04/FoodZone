require(["ta/rollupAmdShim"],function(a){a.install(["ta/photos/oysterTracking","utils/HistoryManager","ta/media/player/TA_JWPlayer"],["ta","ta","ta","ta","ta"])});if(window.requirejs&&requirejs.taConfig){requirejs.taConfig({deferred:{},name:"media_albums_extended",files:{"js-amd":{src:{utils:{HistoryManager:1}}},js3:{src:{ta:{media:{player:{TA_JWPlayer:1}},photos:{oysterTracking:1}}}}},_:{baseUrl:"/"}})};define("vanillajs",[],function(){return{}});define("ta/photos/oysterTracking",["vanillajs"],function(c){var b=["LB_OPEN","FEATURED_REEL","EOAR_SINGLE","EOAR_HERO","PHOTO_CONTENT_BLOCK","FEATURED_REEL_LR","HERO","ALBUM"];function a(d){return b.contains(d)}return{trackCandidateSession:function(g,d,f){if(a(f)){ta.trackEventOnPage("Oyster","CANDIDATE_SESSION",f)}},trackImpression:function(g,d,f){if(a(f)){ta.trackEventOnPage("Oyster","IMPRESSION",f)}},trackInterest:function(g,d,f){if(a(f)){ta.trackEventOnPage("Oyster","INTEREST",f)}},trackAction:function(g,d,f){if(a(f)){ta.trackEventOnPage("Oyster","ACTION",f)}}}});define("lib/jquery-amd",[],function(){return window.Zepto||ta.jquery||window.jQuery});define("mixins/mixin",["vanillajs"],function(a){return function(e){var c=Array.prototype.slice.call(arguments,1),b,f;for(var d in c){if(!c.hasOwnProperty(d)){continue}b=c[d];for(f in b){e[f]=b[f]}}return e}});define("mixins/Events",["vanillajs"],function(b){var a=function(){this.events={};Array.prototype.slice.call(arguments).forEach(function(c){this.events[c]=[]},this)};a.create=(function(){function c(d){return a.apply(this,d)}c.prototype=a.prototype;return function(){return new c(arguments)}}());a.extend=function(d,e){var c=Object.create(a.prototype);c.delegate=d;a.apply(c,e);return c};a.prototype.on=a.prototype.addListener=function(d,c){if(this.events[d]!==undefined){this.events[d].push(c)}else{if(this.delegate){this.delegate.on(d,c)}else{this.events[d]=[c]}}return this};a.prototype.off=a.prototype.removeListener=function(e,d){if(this.events[e]!==undefined){if(d){var c=this.events[e].indexOf(d);if(c>=0){this.events[e].splice(c,1)}}else{this.events[e].length=0}}else{if(this.delegate){this.delegate.removeListener(e,d)}}return this};a.prototype.removeAllListeners=function(d){if(d&&this.events[d]!==undefined){this.events[d].length=0}else{if(!d){for(var c in this.events){if(this.events.hasOwnProperty(c)){this.events[c].length=0}}if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners()}}else{if(this.delegate&&this.delegate.removeAllListeners){this.delegate.removeAllListeners(d)}}}};a.prototype.hasListeners=function(c){if(c){if(this.events.hasOwnProperty(c)){return this.events[c].length>0}if(this.delegate&&this.delegate.hasListeners){return this.delegate.hasListeners(c)}}return false};a.prototype.emit=function(e,d){if(this.events[e]){var c=Array.prototype.slice.call(arguments,1);this.events[e].slice(0).forEach(function(g){if(g){try{g.apply(this,c)}catch(i){if(typeof i==="string"){i=new Error(i)}var h="Error in event handler for "+e;if(require.defined("ta/util/Error")){require("ta/util/Error").record(i,h)}else{var f=require.defined("ta")&&require("ta");if(f&&f.log&&f.log.error){f.log.error(i,h)}else{if(f&&f.m&&f.m.recordJSError){f.m.recordJSError([i,h])}else{if(typeof console!="undefined"){(console.error||console.log)(h,i)}}}}}}},this)}else{if(this.delegate&&this.delegate.emit){this.delegate.emit.apply(delegate,arguments)}}return this};return a});define("commerce/offerclickEvents",["mixins/Events","vanillajs"],function(a){return new a("beforeClick","afterClick")});define("ns-exporter",["vanillajs"],function(b){function a(d){if(!d){if(require.defined("ta/util/Error")){require("ta/util/Error").record(null,"Using ns-exporter:exportTo without a namespace")}return null}if(typeof d=="string"){var c=window;if(!c.ta){ta={}}d.split(".").forEach(function(e){if(!c[e]){c[e]={}}c=c[e]});d=c}return d}return{exportTo:function(e,d,f){d=a(d);if(!d){return false}for(var c in e){if(e.hasOwnProperty(c)&&(!f||!(c in d))){d[c]=e[c]}}return true},createNs:function(d,c,e){c=a(c);if(!c){return false}c[e]=d}}});define("utils/asdf-encoder",["ns-exporter","vanillajs"],function(b){var a={};a.getOffset=function(d){if(d>=97&&d<=122){return d-61}if(d>=65&&d<=90){return d-55}if(d>=48&&d<=71){return d-48}return -1};a.asdf=function(f){var j={"":["&","=","p","6","?","H","%","B",".com","k","9",".html","n","M","r","www.","h","b","t","a","0","/","d","O","j","http://","_","L","i","f","1","e","-","2",".","N","m","A","l","4","R","C","y","S","o","+","7","I","3","c","5","u",0,"T","v","s","w","8","P",0,"g",0],q:[0,"__3F__",0,"Photos",0,"https://",".edu","*","Y",">",0,0,0,0,0,0,"`","__2D__","X","<","slot",0,"ShowUrl","Owners",0,"[","q",0,"MemberProfile",0,"ShowUserReviews",'"',"Hotel",0,0,"Expedia","Vacation","Discount",0,"UserReview","Thumbnail",0,"__2F__","Inspiration","V","Map",":","@",0,"F","help",0,0,"Rental",0,"Picture",0,0,0,"hotels",0,"ftp://"],x:[0,0,"J",0,0,"Z",0,0,0,";",0,"Text",0,"(","x","GenericAds","U",0,"careers",0,0,0,"D",0,"members","Search",0,0,0,"Post",0,0,0,"Q",0,"$",0,"K",0,"W",0,"Reviews",0,",","__2E__",0,0,0,0,0,0,0,"{","}",0,"Cheap",")",0,0,0,"#",".org"],z:[0,"Hotels",0,0,"Icon",0,0,0,0,".net",0,0,"z",0,0,"pages",0,"geo",0,0,0,"cnt","~",0,0,"]","|",0,"tripadvisor","Images","BookingBuddy",0,"Commerce",0,0,"partnerKey",0,"area",0,"Deals","from","\\",0,"urlKey",0,"'",0,"WeatherUnderground",0,"MemberSign","Maps",0,"matchID","Packages","E","Amenities","Travel",".htm",0,"!","^","G"]};var e="";for(var d=0;d<f.length;d++){var k=f.charAt(d);var g=k;if(j[k]&&d+1<f.length){d++;g+=f.charAt(d)}else{k=""}var h=getOffset(f.charCodeAt(d));if(h<0||typeof j[k][h]=="String"){e+=g}else{e+=j[k][h]}}return e};b.exportTo(a,window);return a});define("utils/urlutils",["vanillajs","utils/asdf-encoder"],function(e,c){var d=window.asdf||((global&&global.asdf)?global.asdf:c.asdf);function f(l,j,m){var k=new RegExp("(-"+j+"([0-9]+))|([?&]"+m+"=([0-9]+))");var n=k.exec(l);if(n){if(typeof n[2]!=="undefined"){return Number(n[2])}if(typeof n[4]!=="undefined"){return Number(n[4])}}return void (0)}function h(j){return f(j,"d","detail")||f(j,"g","geo")}function i(l){var k={};var o=l.split("#")[0].split("?")[1]||"";var n=o.split("&");for(var m=0;m<n.length;m++){var j=n[m].split("=");if(j[0]){k[decodeURIComponent(j[0])]=decodeURIComponent(j[1])}}return k}function b(l){var k=[];for(var j in l){if(l.hasOwnProperty(j)){k.push(encodeURIComponent(j)+"="+encodeURIComponent(l[j]))}}return k.join("&")}function a(j){return location.protocol+"//"+location.hostname+j}function g(j){j=j||"";if(j.indexOf("http")===-1){j=a(j)}return j.replace("http://","https://")}return{asdf:d,getUrlArgNumeric:f,getUrlPageLoc:h,getUrlQueryArgs:i,toQueryString:b,https:g}});define("utils/stopevent",["vanillajs"],function(){return function(a){if(a){if(a.stopPropagation){a.stopPropagation()}else{a.cancelBubble=true}if(a.preventDefault){a.preventDefault()}else{a.returnValue=false}}return false}});define("utils/waiton",["vanillajs"],function(){return function(d,g,b){var f=0,e=null,a=false;if(!d||d.length==0){g();return}function c(){if(--f<=0&&!a){e&&clearTimeout(e);a=true;g()}}d.forEach(function(h){f++;h(c)});if(b>0){e=setTimeout(function(){f=0;c()},b)}}});define("commerce/offerclick",["ta","mixins/mixin","commerce/offerclickEvents","utils/urlutils","utils/stopevent","utils/waiton","vanillajs"],function(e,j,i,s,p,q){var m=new RegExp("(&|\\?)from=[^&]*");var o=new RegExp("(&|\\?)ob=[^&]*");var r=[];var b=null;function n(u){if(typeof(u)!=="string"){return u}var t=s.asdf(u.trim()).replace(/&amp;/g,"&");if(typeof window!=="undefined"&&window.crPageServlet){t=t.replace(m,"$1from=HotelDateSearch_"+crPageServlet)}if(typeof document!=="undefined"&&document.location&&document.location.href){var v=s.getUrlPageLoc(document.location.href);if(v){t+="&pageLocId="+v}}var w=s.getUrlQueryArgs(t);t=t.replace(o,"");return{url:t,isBooking:(t.indexOf("/StartBooking")>=0),ttP:w.tp,ttIK:w.ik,slot:w.slot,providerName:w.p,ik:w.ik,locId:(w.d||w.geo),area:w.area,contentId:(w.src_0||w.src),trackingContext:w.btc,openBehavior:w.ob}}function d(t){if(typeof t==="function"){r.push(t)}}function h(t){if(t.openBehavior==="same_tab"){return false}if(t.isBooking&&typeof e!=="undefined"&&e.browser&&e.browser.isIE10Metro()){return false}if(typeof e=="undefined"||!e.util||!e.popups||!e.popups.PopUtil){return false}return true}function k(){try{document.domain=document.domain}catch(t){return true}return false}function l(u){u=n(u);var v=k(),t=window.open(v?u.url:"","_blank");if(!t&&typeof(Browser)!=="undefined"&&Browser.ie&&u.isBooking){if(e.util&&e.util.cookie){e.util.cookie.setPIDCookie(38822)}g(u);return}!v&&e.popups.PopUtil.redirectToUrl(t,u.url);r.forEach(function(w){w(u,function(){})});e.popups.PopUtil.pollForPartnerLoad(t,new Date(),u.providerName,u.slot)}function g(t){t=n(t);q(r.map(function(u){return u.bind(null,t)}),function(){if(typeof e!=="undefined"&&e.retrieve&&e.retrieve("ta.isIE11orHigher")){window.open(t.url,"_self",null,false)}else{window.location.href=t.url}})}function f(w,v,u,t){if(w&&!t){p(w)}u=n(u);i.emit("beforeClick",u);if(e.store&&e.retrieve&&v&&v.getAttribute("data-pernight")&&u&&u.ttIK){var x=e.retrieve("CLICK_PRICE_DOUBLE_CHECK");if(!x){x={}}x[u.ttIK]=v.getAttribute("data-pernight");e.store("CLICK_PRICE_DOUBLE_CHECK",x)}if(require.defined("ta/Core/TA.Event")){setTimeout(function(){try{require("ta/Core/TA.Event").fireEvent("metaLinkClick",v,(u.isBooking?"TripAdvisor":u.providerName),u.area,u.locId,u.contentId,"new_tab",u.slot);if(u.isBooking){require("ta/Core/TA.Event").fireEvent("ibOfferClick",v)}}catch(y){require.defined("ta/util/Error")&&require("ta/util/Error").record(y,"Commerce click tracking failed",null,{servlet:window.pageServlet,url:u.url,area:u.area})}},300)}if(b&&b(u)){return false}if(h(u)){l(u)}else{g(u)}i.emit("afterClick",u);return false}function a(t){b=t}var c={expandToken:n,clickEvent:f,registerAsyncPreclick:d,setPreClickHandler:a};return j(c,i)});define("ta/util/Object",["vanillajs","ns-exporter"],function(b,c){var a={};a.typeOf=function(d){return Object.prototype.toString.call(d).match(/(\w+)\]$/)[1].toLowerCase()};a.merge=function(j){for(var e=1;e<arguments.length;e++){var g=arguments[e];if(!g){continue}j||(j=(a.typeOf(g)==="array")?[]:{});for(var d in g){var h=g[d];if(g.hasOwnProperty(d)&&a.typeOf(h)!=="undefined"){var f=a.typeOf(h);if(f==="string"||f==="number"||f==="boolean"||f==="function"||h===null){j[d]=h;continue}j[d]=a.merge(j[d],h)}}}return j};c.exportTo(a,"ta.util");return a});define("ta/Core/TA.Store",["vanillajs","ns-exporter","ta/util/Object"],function(c,e,a){var d={};var b={};b.store=function(f,g){d[f]=g;return g};b.retrieve=function(f){return d[f]};b.has=function(f){return typeof(d[f])!="undefined"};b.retrieveOrStore=function(f,g){var h=d[f];if(typeof(h)=="undefined"){d[f]=g;h=g}return h};b.remove=function(f){var g=d[f];delete d[f];return g};b.keep=function(h,i){var f=b.retrieve(h),g;if(f){g=f instanceof Array?f:[f]}else{g=[]}if(i instanceof Array){i.forEach(function(j){if(!g.contains(j)){g.push(j)}})}else{g.push(i)}b.store(h,g)};b.merge=function(f,g){b.store(f,a.merge(b.retrieve(f)||{},g))};b.asInt=function(g,f){var h=parseInt(b.retrieve(g));return isNaN(h)?(f||0):h};b.asFloat=function(h,g){var i=parseFloat(b.retrieve(h));return isNaN(i)?(g||0):i};b.executeCallbacks=function(g){if(b.has(g)){var h=b.retrieve(g);if(!h instanceof Array){return}for(var f=0;f<h.length;f++){h[f]()}}};e.exportTo(b,"ta");return b});define("purify",["vanillajs"],function(c){function b(e,d){if(!e){return e}if(a(e)){if(window.IS_DEBUG){console.error("You're using a jQuery object where you shouldn't. Check the stack trace and fix it!")}return d&&e.length>1?e.get():e.get(0)}return e.forEach&&(e.length<=1||!d)?e[0]:e}function a(d){return !!(d.animate&&d.get&&d.eq&&d.each)}return b});define("utils/json-to-url",["vanillajs"],function(){return function(a){if(!a){return""}return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}});define("ajax-request",["utils/json-to-url","vanillajs"],function(d){function b(f){var e=document.createElement("a");e.href=f;return e.protocol!==window.location.protocol||e.host!==window.location.hostname}function a(e,f){try{if(!b(e)){f.setRequestHeader("X-Requested-With","XMLHttpRequest")}}catch(g){}try{f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(g){}try{f.setRequestHeader("Accept","text/html, */*")}catch(g){}}function c(){try{return new XMLHttpRequest()}catch(g){try{return new ActiveXObject("MSXML2.XMLHTTP")}catch(f){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw new Error("Can't create XMLHttpRequest or similar")}}}}return function(e,f){if(typeof e==="object"){f=e;e=f.url}f=f||{};var h=f.method||f.type||"GET";var g=typeof f.data==="string"?f.data:d(f.data);return new Promise(function(k,j){var i=c();var l=false;i.onreadystatechange=function(){if(!l&&i.readyState===XMLHttpRequest.DONE){l=true;if(i.status>=200&&i.status<=299){f.success&&f.success(this.responseText,this.status,i);k(this.responseText)}else{f.error&&f.error(i,this.status,this.statusText);j(this.responseText)}f.complete&&f.complete(i,this.statusText)}};if(h.toLowerCase()==="get"&&typeof g==="string"&&g.length>0){e+=(g[0]==="?"?"":"?")+g;g=null}i.open(h,e,!f.synchronous);a(e,i);i.send(g)})}});define("ta/Core/TA.Record",["vanillajs","ns-exporter","ta/Core/TA.Store","purify","ajax-request"],function(v,g,d,S,B){var G={};var I={};var M=[];var R=8;var b="impressionTrackingTree";var f=0,h=1,p=2;var j=[];var H=60;var L=function(ab){return typeof ab==="function"};var C=function(){var ac=["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],ae;if(window.XMLHttpRequest){ae=new XMLHttpRequest()}else{for(var ab=0;ab<ac.length;ab++){try{ae=new ActiveXObject(ac[ab]);break}catch(ad){}}}return ae};var n=function(ab,ac){try{if(!ab||typeof ac!=="object"){return}if(window.JSON&&JSON.stringify){var ad=JSON.stringify(ac);if(ad&&ad.length<100000){j.push([ab,ad]);if(j.length>H){j.shift()}}}}catch(ae){}};var u=function(ag,ac,ah){if(!ag||typeof ac!=="object"){F(new Error("postUrl/dataObj is null/empty/undefined"),"TA.Record _simpleAjaxPost",null,arguments);if(ah){ah()}return}var ad;if(typeof Request!=="undefined"&&window.MooTools){ad={url:ag,method:"post",data:ac};if(ah){ad.onComplete=ah;ad.timeout=3000}var ae=new Request(ad).send();n(ag,ac);return ae}else{if(typeof Zepto!=="undefined"&&Zepto&&L(Zepto.ajax)){ad={type:"POST",url:ag,data:ac,error:function(ak,ai){var aj=/InvalidTrackingTreeException/;if(window.IS_DEBUG&&new RegExp(aj).exec(ak.response)){var al=/Caused by:\s(.*)\n/;alert("TRACKING ERROR DETECTED\n"+new RegExp(al).exec(ak.response)[1])}F(new Error("XHR error, errorType = "+ai),"TA.Record _simpleAjaxPost",null,arguments)}};if(ah){ad.complete=ah;ad.timeout=3000}Zepto.ajax(ad)}else{if(typeof jQuery=="function"){ad={url:ag,type:"POST",data:ac};if(ah){ad.complete=ah;ad.timeout=3000}jQuery.ajax(ad)}else{var ab=C(),af=i(ac);ab.open("POST",ag);ab.setRequestHeader("Content-type","application/x-www-form-urlencoded");ab.send(af)}}}n(ag,ac)};var F=function(){if(require.defined("ta/util/Error")){var ab=require("ta/util/Error");ab.record.apply(ab,arguments)}else{if(ta&&ta.m&&L(ta.m.recordJSError)){ta.m.recordJSError(arguments)}}};var D=function(ab){if(typeof ab=="undefined"||ab==null){return""}if(typeof ab!=="string"){ab=ab.toString()}return ab.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*")};var aa=function(ae){var ab=[];for(var ac in ae){var ad=ae[ac];ab.push(D(ac)+"."+D(ad))}return ab.join("*")};var z=function(ab){if(typeof ab=="undefined"||ab===null){return""}if(typeof ab!=="string"){ab=ab.toString()}return ab.replace(/!/g,"!!").replace(/\./g,"!.").replace(/\*/g,"!*").replace(/\~/g,"!~")};var t=function(ae){var ab=[];for(var ac in ae){var ad=ae[ac];ab.push(z(ac)+"."+z(ad))}return ab.join("*")};var r=function(ab){var ac=/(https?:\/\/[^\/]+)?\/([^#.?-]*)/;var ad=ac.exec(ab);if(ad){if(typeof ad[2]!="undefined"){return(ad[2])?ad[2]:"Home"}}return null};var W=function(){var ab=G.getPageData();if(ab&&ab.url){return ab.url.substring(1)}else{var ac=/\/([^-]*)/.exec(window.location.pathname);return ac?ac[1]:null}};var X=function(ad,ab,ae){var ac=new RegExp("(-"+ab+"([0-9]+))|([?&]"+ae+"=([0-9]+))");var af=ac.exec(ad);if(af){if(typeof af[2]!="undefined"){return af[2]}if(typeof af[4]!="undefined"){return af[4]}}return null};var N=function(ab){return X(ab,"d","detail")||X(ab,"g","geo")};var P=function(ab){var ac=document.cookie.match("(?:^|;)\\s*"+ab+"=([^;]*)");if(ac){ac=ac[1];if(ac.indexOf("%1%")===0){ac=ac.substring(3)}return decodeURIComponent(ac)}return false};var s=function(ae,af,ac){try{var ab;if(ac.encode){af=encodeURIComponent(af)}if(ac.domain){af+="; domain="+ac.domain}if(ac.path){af+="; path="+ac.path}if(ac.duration){ab=new Date();ab.setTime(ab.getTime()+ac.duration*1000);af+="; expires="+ab.toGMTString()}if(ac.secure){af+="; secure"}document.cookie=ae+"="+af}catch(ad){F(ad,"_setCookieInSeconds",null,arguments)}};var Z=function(){if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){return ta.m.store.get("bookingSessionId")}return null};var E=function(){var ab=false;if(typeof ta.userLoggedIn==="boolean"){if(typeof ta.userSecurelyLoggedIn==="boolean"){ab=ta.userLoggedIn?(ta.userSecurelyLoggedIn?p:h):f}else{ab=ta.userLoggedIn}}return ab};var U=function(ae,ac){var ab={gac:ae[1],gaa:ae[2],gal:ae[3],gav:ae[4],gani:ae[5],gass:W(),gasl:N(document.location.href),gads:r(ac),gadl:N(ac),gapu:ta.uid,gams:E()},ad=Z();if(!ab.gass){throw new Error("Src servlet undefined, gac:"+ab.gac+", gaa:"+ab.gaa+", gal:"+ab.gal)}if(!ab.gads){throw new Error("Dst servlet undefined. gac:"+ab.gac+", gaa:"+ab.gaa+", gal:"+ab.gal)}if(d.has("gatt")){ab.gatt=d.retrieve("gatt")}if(ad){ab.bsid=ad}s("EVT",aa(ab),{domain:cookieDomain,duration:5,encode:true,path:"/"})};var V=function(ae){if(!ae||!ae.className||!ae.firstChild){return false}var ad=new RegExp("\\b"+b+"\\b"),ab=ae.firstChild.nodeType,ac=ae.firstChild.nodeValue;return ad.test(ae.className)&&ab===R&&ac!==""};var k=function(){};if(require.defined("page-model")){require(["page-model"],function(ab){var ad=ab.session;var ac=ad.analyticsInfo;if(ac){d.keep("partials.pageProperties",ac.pagePropertyStringForCurrentPageview);d.store("gaMemberState",ac.memberState);if(ad.analyticsInfo&&require.defined("ta/Core/TA.Prerender")){require("ta/Core/TA.Prerender")._init(true)}}k=function(){if(ac){M.push(JSON.parse(ac.jsonForCurrentPageview))}k=function(){}}})}G.getPageData=function(){k();return M[M.length-1]};G.pushPageData=function(ab){k();if(ab){M.push(ab)}};G.popPageData=function(){k();return M.pop()};G._GARecordRequest=function(ag,ae){var ac={gac:ag[1],gaa:ag[2],gal:ag[3],gav:ag[4],gani:ag[5],gass:W(),gasl:document.location?N(document.location.href):null,gapu:ta.uid,gams:E()},af=Z(),ab;if(ae){ac.gacl=ae}if(d.has("gatt")){ac.gatt=d.retrieve("gatt")}if(af){ac.bsid=af}var ad;try{if(d.retrieve("batch_garecord")){ad=require("utils/BatchRequest")}else{if(ta.m&&ta.m.batch_garecord_mobile){ad=require("mobile/lite/batch-request")}}}catch(ah){}if(ad){ab={get:function(){ad.queue("/GARecord",ac)}}}else{ab={get:function(){setTimeout(function(){var ai=new XMLHttpRequest();ai.open("GET","/GARecord?"+i(ac),true);ai.send(null)},1)}}}n("/GARecord",ac);return ab};var i=function(ac){var ad=[];for(var ab in ac){ad.push(encodeURIComponent(ab)+"="+encodeURIComponent(ac[ab]))}return ad.join("&")};I.urlArgLookup=function(ae,ab){var ad=new RegExp("[\\?&]"+ae+"=(\\w+)");var ac=ad.exec(ab);if(ac&&typeof ac[1]!="undefined"){return ac[1]}return null};G._validatedTrackEventArray=function(ad,af,ab,ae,ac){if(ad&&typeof ad!="string"){ad=ad.toString()}if(af&&typeof af!="string"){af=af.toString()}if(ab&&typeof ab!="string"){ab=ab.toString()}if(!ae){ae=0}else{if(typeof ae!="number"){ae=parseFloat(ae);if(isNaN(ae)){ae=0}}}if(typeof ac!="boolean"){ac=(ac===true)}return["_trackEvent",ad,af,ab,ae,ac]};G._toEvtParams=function(ad){try{var ab={gac:ad.module,gaa:ad.action,gal:ad.context,gav:ad.value,gani:ad.noninteraction};ab.gass=W();ab.gasl=N(document.location.href);ab.gapu=ta.uid;ab.gams=E();return ab}catch(ac){F(ac,"analytics._toEvtParams",null,ad)}};G._trackEventAfterAjax=function(ac){try{I.trackDMPBehavior(ac.module,ac.action,ac.context,ac.value,ac.noninteraction)}catch(ab){F(ab,"analytics._trackEventAfterAjax",null,ac)}};I.getEventPathOptions=function(ag,ad,ac){try{var af=w(ac,ag);if(!af){F(null,"ta.getEventPathOptions - invalid element",null,arguments);return}var ab=K(af);if(ad){ab.noninteraction=ad}return ab}catch(ae){F(ae,"ta.getEventPathOptions",null,arguments)}};G._trackEventPathAfterAjax=function(ab){try{I.trackEventOnPage(ab.category,ab.action,ab.label,ab.value,ab.noninteraction)}catch(ac){F(ac,"analytics._trackEventPathAfterAjax",null,arguments)}};I.trackPhysicalCommerce=function(ad,ac,ag,ab){try{var ae=G._validatedTrackEventArray(ad,"Commerce-Physical",ac,ag,false);G._GARecordRequest(ae,ab).get()}catch(af){F(af,"ta.trackPhysicalCommerce",null,arguments)}};I.trackAttemptedCommerce=function(ac,ab,ae){try{I.trackDMPBehavior(ac,ab,ae,null,null)}catch(ad){F(ad,"ta.trackAttemptedCommerce",null,arguments)}};I.trackPhysicalAndAttemptedCommerce=function(ad,ac,ae,af,ab){I.trackPhysicalCommerce(ad,ac,af,ab);I.trackAttemptedCommerce(ad,ac,ae,af)};I.trackImpressionEventOnPage=function(ac,ae,ab,ad){ac=ac||"";ae=ae||"";ab=ab||"";ad=ad||0;I.trackEventOnPage(ac,ae,ab,ad,true)};I.trackEventOnPage=function(ac,ag,ab,af,ae){try{var ad=G._validatedTrackEventArray(ac,ag,ab,af,ae);G._GARecordRequest(ad).get();I.trackDMPBehavior(ac,ag,ab,af,ae)}catch(ah){F(ah,"ta.trackEventOnPage",null,arguments)}};I.trackEventOnPageOnce=function(af,ah,ad,ae){var ab="eventsAlreadyTracked",ag;if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){ag=ta.m.store.get(ab)}else{ag=d.retrieve(ab)}if(!ag){ag={};if(ifdefNN(ta)&&ifdefNN(ta.m)&&ifdefNN(ta.m.store)){ta.m.store.add(ab,ag)}else{d.store(ab,ag)}}var ac=af+"|"+ah+"|"+ad;if(!ag[ac]){I.trackEventOnPage(af,ah,ad,0,ae);ag[ac]=true}};I.trackDMPBehavior=function(ad,ag,ac,af,ae){try{if(require.defined("ta/common/behavior/dmp/DMP")){var ab=require("ta/common/behavior/dmp/DMP");if(ab.isEnabled()){ab.sendGABehavior(ad,ag,ac,af,ae)}}}catch(ah){F(ah,"Error adding and sending GARecord behavior to DMP")}};I.setEvtCookie=function(ae,ah,ad,ag,ac){try{var af=G._validatedTrackEventArray(ae,ah,ad,ag,false);U(af,ac);if(require.defined("ta/common/behavior/dmp/DMP")){var ab=require("ta/common/behavior/dmp/DMP");if(ab.isEnabled()){ab.sendEventBehavior(ae,ah,ad,ag,T())}}}catch(ai){F(ai,"ta.setEvtCookie",null,arguments)}};var x=function(ad){var ac;try{ac=P("MEVT")||"";if(ac.length>0){ac+="~"}ac+=t(ad);if(ac.length>1024){throw"MEVT Cookie is full"}s("MEVT",ac,{domain:cookieDomain,duration:5,encode:true})}catch(ab){F(ab,"_appendMevtCookie",null,arguments);return false}return true};var m="trk";var a=m.length;var Q="etk";var q=/^([A-Z]{1,2}:)?[A-Za-z_0-9\-\.]+$/;var T=function(){var ab=(typeof event!="undefined")?event:window.event;if(ab){return ab.target||ab.srcElement}return document.activeElement};G.getCommentTrackingPath=function(ab,ac){return w(ab,ac)};var w=function(ah,aj){ah=S(ah);if(!ah){ah=T();if(!ah){F(null,"_getCommentTrackingPath - no element provided or event target element",null,arguments);return null}}if(ah.nodeType!=1){return null}var am=[];if(aj&&typeof aj=="string"&&aj!==""){if(q.test(aj)){if(aj.substring(0,2)=="P:"){am.push(aj.substring(2));return am}else{am.push(aj)}}}if(typeof ah.previousSibling==="undefined"){F(null,"_getCommentTrackingPath - browser does not support previousSibling",null,arguments);return am}LOOP_PARENT_NODES:for(var ae=ah;ae!=document.body;ae=ae.parentNode){if(ae==null){F(null,"_getCommentTrackingPath - LOOP_PARENT_NODES got unexpected null node",null,arguments);break}var ak=0;for(var ab=ae.previousSibling;ab!=null;ab=ab.previousSibling){if(ab.nodeType==R){var ad=ab.nodeValue;if(ad==Q){ak++;continue}if(ad.substring(0,a)!=m){continue}if(ak>0){ak--;continue}var ag=ad.substring(a).split("/");if(!ag){F(null,'ta._getCommentTrackingPath - cannot split context class: "'+ad+'"',null,arguments)}for(var al=ag.length-1;al>=0;al--){var ac=ag[al];var ai=q.exec(ac);if(!ai){F(null,'ta._getCommentTrackingPath - tracking prefix used with invalid context: "'+ag[al]+'"',null,arguments);continue}if(ai[1]=="P:"){var af=ai[0].substring(2);am.push(af);break LOOP_PARENT_NODES}else{am.push(ai[0])}}}}}return am};var K=function(ad){if(ad.length===0){return null}var ab={action:ad[0],label:"",value:"1",category:ad[ad.length-1]};ad.shift();for(var ac=ad.length-2;ac>=0;ac--){ab.label+=ad[ac];if(ac>0){ab.label+="/"}if(ad[ac].substring(0,2)=="N:"){ab.value=ad[ac].substring(2)}}if(ab.label===""){ab.label="Unknown"}return ab};I.trk=function(af,ah,ae,ac){ae=S(ae);try{var aj=ae?ae.getAttribute("data-trk-path"):null;if(aj){aj=aj.replace("P:","");aj=aj.split("/");aj.reverse()}else{aj=w(ae,af);if(!aj||!aj.length){var ad="";if(ae){if(ae.outerHTML){var ai=document.createTextNode(ae.outerHTML);var ab=document.createElement("div");ab.appendChild(ai);ad=ab.innerHTML.substring(0,100)}else{if(ae.nodeName){ad=ae.nodeName}else{ad+=ae}}}else{if(ae===undefined){ad="undefined"}else{if(ae===null){ad="null"}}}if(!af){if(aj===null){af="null path"}else{if(aj===undefined){af="undefined path"}else{if(aj.hasOwnProperty("length")){if(aj.length===0){af="empty path"}else{af=aj.join(",")}}else{af="path: "+aj}}}}F(null,"ta.trk - invalid element for "+af+" from "+ad,null,arguments);return}}I.trkWithPath(aj,ah,ac)}catch(ag){F(ag,"ta.trk",null,arguments)}};I.trkWithPath=function(ag,ae,af){try{if(!ag||!ag.length){F(null,"ta.trkWithPath - no path in arguments",null,arguments);return}if(af&&af.length>0&&ag.length&&ag.splice){for(var ac=af.length-1;ac>=0;ac--){if(typeof(af[ac])==="string"){ag.splice(1,0,af[ac])}}}var ab=K(ag);I.trackEventOnPage(ab.category,ab.action,ab.label,ab.value,ae)}catch(ad){F(ad,"ta.trkWithPath - "+ad,null,arguments)}};I.trkImpTree=function(ac){try{if(!V(ac)){F(null,"ta.trkImpTree called with invalid trackTreeElem!",null,arguments);return}var ab=ac.firstChild.nodeValue;o(ab)}catch(ad){F(ad,"ta.trkImpTree",null,arguments)}};I.recordImpression=function(ab,ad){if(!ab){if(ad){ad()}return}try{o(J(ab),ad)}catch(ac){F(ac,"ta.recordImpression",null,arguments);if(ad){ad()}}};var A="<!--";var y="-->";var J=function(ab){var ac=ab.indexOf(A),ad=0,ae=ab.indexOf(y);if(ac!==-1){ad=ac+A.length}if(ae===-1){ae=ab.length}return ab.substring(ad,ae)};G.stripCommentsFromTree=J;var l="\\";var c="/";G.appendAscendTokens=function(ac){var ae=0,ad=0,ab=0;for(ae=0;ae<ac.length;ae++){if(ac[ae]===c){ab++}else{if(ac[ae]===l){ad=ae+1;while(ad<ac.length&&ac[ad]===l){ab--;ae=ad;ad++}}}}if(ab>0){for(ae=0;ae<ab;ae++){ac+=l}}return ac};var o=function(ab,ad){var ac={tTreeStr:ab&&ab.trim(),tTreeUid:ta.uid&&ta.uid.trim(),tTreeLastReferrer:window.location.href,tTreeIsMemberSignedIn:E()};if(ta.m&&ta.m.store&&ta.m.store.has("bookingSessionId")){ac.bsid=ta.m.store.get("bookingSessionId")}if(!ac.tTreeStr){F(new Error("tTreeStr is null/undefined/empty."),"ta._sendTreeImpression",null)}else{if(!ac.tTreeUid){F(new Error("tTreeUid is null/undefined/empty."),"ta._sendTreeImpression",null)}}if(d.retrieve("js_impression_unified_ajax")){B("/ImpressionRecord",{method:"POST",url:"/ImpressionRecord",data:ac}).then(ad,ad);n("/ImpressionRecord",ac)}else{u("/ImpressionRecord",ac,ad)}};I.setEvtCookieAndPath=function(ag,ab,ad){try{if(!ad){ad=T()}var af=w(ad,ag);if(!af){F(null,"ta.setEvtCookieAndPath - invalid element for "+ag,null,arguments);return}var ac=K(af);if(!ab){while(ad.nodeName!="A"){if(ad==document.body){break}ad=ad.parentNode}ab=ad.href;if(!ab){F(null,"ta.setEvtCookieAndPath - no url parameter and cannot find a.href",null,arguments);return}}I.setEvtCookie(ac.category,ac.action,ac.label,ac.value,ab)}catch(ae){F(ae,"ta.setEvtCookieAndPath",null,arguments)}};I.recordPageview=function(ac,af){if(!ac){return}var ab=r(ac),ae="/PageviewRecord",ad=af?af:{};if(ab){ad.servletName=ab;u(ae,ad)}};I.recordTabView=function(ag,ac,af){if(!ag||!ac){return}var ab=ag+"-"+ac,ae="/PageviewRecord",ad=af?af:{};if(ab){ad.servletName=ab;u(ae,ad)}};I.resetPageDataUrl=function(){var ab=G.getPageData();if(ab){ab.url=""}};I.trackEngagementClick=function(ab,ac){if(!ab||!ac){F(new Error("object/selectionFunction is null/undefined"),"ta.trackEngagementClick",null,arguments);return}if(!L(ac)){F(new Error("passed variable selectionFunction is not a function"),"ta.trackEngagementClick",null,ac);return}ac(ab)};I.placementNodeSelectorTracker=function(ah){if(!ah||!ah.element||!ah.type){F(new Error("object/element/type is null/undefined"),"ta.placementNodeSelectorTracker",null,ah);return}var am=ah.element;var ag=ah.type;var ai;var ad;var ap;var ao;var ac;var al;var ae=G.getCommentTrackingPath(am);ag=ag+"_Click";if(!ae){F(new Error("trackTreePath is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}if(ae.length<1){F(new Error("trackTreePath is missing information"),"ta.placementNodeSelectorTracker",null,arguments);return}ai=ae[ae.length-1];if(!ai){F(new Error("placement is null/undefined"),"ta.placementNodeSelectorTracker",null,ae);return}for(al=ae.length-1;al>=0;al--){ac=ae[al];if(!ac){continue}if(ac.indexOf("N:")===0){ad=ac;break}}if(ai==="HH_MainList"||ai==="Maps_MetaBlock"){ad="N:1"}else{if(!ad){F(new Error("positionNode is null/undefined"),"ta.placementNodeSelectorTracker",null,ae);return}}ap=ad.split(":");if(ap&&ap.length===2){ao=ap[1]}else{F(new Error("positionSplit appears to be incorrect"),"ta.placementNodeSelectorTracker",null,arguments);return}if(!ao){F(new Error("position is null/undefined"),"ta.placementNodeSelectorTracker",null,arguments);return}var ak=parseInt(ao,10);if(isNaN(ak)){F(new Error("position is not a number"),"ta.placementNodeSelectorTracker",null,ao);return}var ar=Y(ai);if(ar===-1){return}ao=ak+ar;ai=e(ai);if(ai==="hotels_slot_x"){var aq=document.getElementById("slotXListingWrap");if(aq){var ab=aq.getAttribute("data-prodAttr");var an=parseInt(aq.getAttribute("data-prodId"),10);I.trackEventOnPage(ai,ag,ab,an+1)}return}var af;var aj=document.querySelectorAll(".ui_tab_bar .ui_tab.selected");if(aj.length===1){aj=aj[0];af=aj.getAttribute("data-currentSort")}I.trackEventOnPage(ai,ag,af,ao)};var e=function(ab){if(!ab){return ab}if(W()!=="Hotels"){return"Clicks_"+ab}var ac;if(ab==="Hotels_MainList"||ab==="Hotels_MainList_Sponsored"||ab==="Hotels_MainList_Discovery_Sponsored_Listing"){ac="Clicks_"+ab}else{if(ab==="hotels_list_short_cells2"){ac="Clicks_Hotels_MainList"}else{if(ab==="sponsored_coupon_listing"){ac="Clicks_Hotels_MainList_Sponsored"}else{if(ab==="DesktopSlotX"||ab==="MobileSlotX"||ab==="Hotels_SlotX_Sponsored"){return"hotels_slot_x"}}}}if(document.getElementById("sponsoredCouponListingWrap")&&ac==="Clicks_Hotels_MainList"){ac+="_Sponsored"}ac+=(ta.widgets.calendar.getCheckRatesData())?"_PostDates":"_PreDates";return ac};var Y=function(ae){if(!ae){F(new Error("placement is null/undefined"),"ta._shiftOrdinalsWithSponsoredPlacement",null,ae);return -1}if(W()!=="Hotels"){return 0}var ac=0;var ag=d.retrieve("hac.offset");if(ag&&ag>0){ac=ag}if(!document.getElementById("sponsoredCouponListingWrap")){return ac}var ad=document.querySelector("#HAC_RESULTS .pageNumbers .current");var ab;if(ad){var af=ad.getAttribute("data-page-number");ab=parseInt(af,10);if(isNaN(ab)||!ab){F(new Error("pageNumber is not a number"),"ta._shiftOrdinalsWithSponsoredPlacement",null,af);return -1}}if(ae==="hotels_list_short_cells2"||ae==="Hotels_MainList"){ac+=ab;return ac}if(ag&&ag>0&&(ae==="sponsored_coupon_listing"||ae==="Hotels_MainList_Sponsored"||ae==="Hotels_MainList_Discovery_Sponsored_Listing")){ac+=(ab-1)}return ac};I.getRecentTARecords=function(){return j};I.addTypeAheadMevt=function(ab){ab.t="ta";return x(ab)};I.addGARecordMevt=function(ae,af,ad,aj,ac){try{var ab=G._validatedTrackEventArray(ae,af,ad,aj,false),ai={t:"ga",gac:ab[1],gaa:ab[2],gal:ab[3],gav:ab[4],gani:ab[5],gass:W(),gasl:N(document.location.href),gads:r(ac),gadl:N(ac),gapu:ta.uid,gams:E()},ag=Z();if(!ai.gass){throw new Error("Src servlet undefined, gac:"+ai.gac+", gaa:"+ai.gaa+", gal:"+ai.gal)}if(!ai.gads){throw new Error("Dst servlet undefined. gac:"+ai.gac+", gaa:"+ai.gaa+", gal:"+ai.gal)}if(d.has("gatt")){ai.gatt=d.retrieve("gatt")}if(ag){ai.bsid=ag}x(ai);if(require.defined("ta/common/behavior/dmp/DMP")){var ak=require("ta/common/behavior/dmp/DMP");if(ak.isEnabled()){ak.sendEventBehavior(ae,af,ad,aj,T())}}}catch(ah){F(ah,"ta.addGARecordMevt",null,arguments)}};g.createNs(G,"ta","analytics");g.exportTo(I,"ta");var O={};g.exportTo(G,O);g.exportTo(I,O);return O});define("utils/browserutils",["vanillajs"],function(e){var d={},b=window.navigator?window.navigator.userAgent.toLowerCase():"",a=window.navigator?window.navigator.platform.toLowerCase():"",c=b.match(/(opera|ie|firefox|chrome|trident|version)[\s\/:]([\w\d\.]+)?.*?(safari|version[\s\/:]([\w\d\.]+)|$)/)||[null,"unknown",0],f=c[1]=="ie"&&document.documentMode;if(c[1]==="trident"){c[1]="ie";c[2]=parseInt(c[2],10)+4}d.name=(c[1]=="version")?c[3]:c[1];d.version=f||parseFloat((c[1]=="opera"&&c[4])?c[4]:c[2]);d.Platform={name:b.match(/ip(?:ad|od|hone)/)?"ios":(b.match(/(?:webos|android)/)||a.match(/mac|win|linux/)||["other"])[0]};d[d.name]=true;d[d.name+parseInt(d.version,10)]=true;d.Platform[d.Platform.name]=true;return d});define("utils/throttle",["vanillajs"],function(){return function(e,b,a){var d=Date.now(),c;return function f(){if(c){clearTimeout(c);c=0}if(Date.now()-d<b){if(!a){c=setTimeout(e.apply.bind(e,this,arguments),b)}return}var g=e.apply(this,arguments);d=Date.now();return g}}});define("utils/form-to-json",["vanillajs"],function(){function a(b,d,c){if(b in c){if(!Array.isArray(c[b])){c[b]=[c[b]]}c[b].push(d)}else{c[b]=d}}return function(d){var h={};var l={file:1,reset:1};var c={DATALIST:1,OUTPUT:1};var g={checkbox:1,radio:1};for(var j=0;j<d.elements.length;j++){var f=d.elements[j];var b=f.name;if(b){var n=f.nodeName,m=f.type;if(n==="SELECT"){for(var e=0;e<f.options.length;e++){var k=f.options[e];if(k.selected){a(b,k.value,h)}}}else{if(n==="INPUT"){if(m in g){if(f.checked){a(b,f.value,h)}}else{if(!(m in l)){a(b,f.value,h)}}}else{if(!(n in c)){a(b,f.value,h)}}}}}return h}});define("api-mod",["lib/jquery-amd","utils/browserutils","utils/throttle","utils/stopevent","utils/form-to-json"],function($,browser,throttle,stopEvent,formToJson){var exports={};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=null;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split(".");var n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.bind=function(fn,obj){return Function.prototype.bind.apply(fn,Array.prototype.slice.call(arguments,1))};exports.bindAll=function(obj,_funcs_){if(arguments.length>1){Array.prototype.slice.call(arguments,1).forEach(function(name){obj[name]=this.bind(obj[name],obj)},this)}else{for(var name in obj){if(obj.hasOwnProperty(name)){obj[name]=this.bind(obj[name],obj)}}}return obj};exports.inDocument=function(elmt){elmt=exports.find(elmt);return !!elmt.parentNode&&elmt.parentNode.nodeType!==11};exports.addEvent=function(elmt,type,fn){$(elmt).on(type,fn)};exports.fireEvent=function(elmt,type,args){$(elmt).trigger(type,args)};exports.removeEvent=function(elmt,type,fn){$(elmt).off(type,fn)};exports.removePropertyEvent=function(elmt,type,fn){if(type.substr(0,2)!=="on"){type="on"+type}var property=elmt.getAttribute(type);if(!property){return}var newVal;var escFn=fn.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");newVal=property.replace(new RegExp(escFn+"\\s*\\([^)]*\\);?|(ta\\.call|requireCallLast|requireCallIfReady)\\s*\\(\\s*['\"]\\s*"+escFn+"[^)]*\\);?"),"");elmt[type]=newVal.trim()};exports.store=function(elmt,key,value){$(elmt).data(key,value)};exports.retrieve=function(elmt,key){return $(elmt).data(key)};exports.getSize=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}if(/^(?:body|html)$/i.test(elmt.tagName)||elmt===window||elmt===document){var win=(!document.compatMode||document.compatMode==="CSS1Compat")?document.body.parentNode:document.body;return{x:win.clientWidth,y:win.clientHeight}}return{x:elmt.offsetWidth,y:elmt.offsetHeight}};exports.getPosition=function(elmt,relativeTo){relativeTo=$(relativeTo);elmt=$(elmt);if(relativeTo.length){var refOff=relativeTo.offset();var eltOff=elmt.offset();return{left:eltOff.left-refOff.left,top:eltOff.top-refOff.top}}else{return elmt.offset()}};exports.getCoords=function(elmt){elmt=exports.find(elmt);if(!elmt){return null}var size=this.getSize(elmt);var position=this.getPosition(elmt);return{top:position.top,left:position.left,bottom:position.top+size.y,right:position.left+size.x,height:size.y,width:size.x}};exports.getOffsetParent=function(elmt){return $(elmt).offsetParent().get(0)};exports.getParent=function(elmt,className){elmt=exports.find(elmt);if(!elmt){return null}if(className){for(;elmt&&elmt.tagName!="html";elmt=elmt.parentNode){if(exports.hasClass(elmt,className)){return elmt}}return null}else{return elmt.parentNode}};exports.elementOrParentMatches=function(elmt,matcher){if(matcher){for(;elmt;elmt=elmt.parentElement){if(matcher(elmt)){return true}}}return false};exports.containsElement=function(parentElement,childElement){parentElement=exports.find(parentElement);childElement=exports.find(childElement);if(!parentElement||!childElement){return false}while(childElement!=null){if(childElement===parentElement){return true}childElement=childElement.parentElement}return false};exports.checkBrowser=function(_args_){var args=Array.prototype.slice.call(arguments);return args.some(function(b){return !!browser[b]})};exports.containsEvent=function(elmt,evnt){elmt=exports.find(elmt);if(!evnt||!elmt){return false}var x=evnt.pageX,y=evnt.pageY;var s=this.getCoords(elmt);if("fixed"===$(this.getOffsetParent(elmt)||elmt).css("position")||typeof x==="undefined"||typeof y==="undefined"){x=evnt.clientX;y=evnt.clientY}return(y>=s.top&&y<=s.bottom&&x>=s.left&&x<=s.right)};exports.select=function(arg1,arg2){var args=Array.prototype.slice.call(arguments);var context=args.length>1&&(("string"===typeof args[0])?args.pop():args.shift())||document;var selector=args.shift();try{return $(selector,context).get()}catch(e){return[]}};exports.addClass=function(elmt,className){$(elmt).addClass(className)};exports.removeClass=function(elmt,className){$(elmt).removeClass(className)};exports.toggleClass=function(elmt,className,state){$(elmt).toggleClass(className,state)};exports.hasClass=function(elmt,className){return elmt&&$(elmt).hasClass(className)};exports.destroy=function(elmt){$(elmt).remove().get()};exports.find=function(selector,elmt){try{return $(selector,elmt||document)[0]}catch(e){}};exports.scrollTop=function(){var supportPageOffset=window.pageYOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageYOffset:isCSS1Compat?document.documentElement.scrollTop:document.body.scrollTop};exports.scrollLeft=function(){var supportPageOffset=window.pageXOffset!==undefined;var isCSS1Compat=((document.compatMode||"")==="CSS1Compat");return supportPageOffset?window.pageXOffset:isCSS1Compat?document.documentElement.scrollLeft:document.body.scrollLeft};exports.createElement=function(tag,attributes){var el=document.createElement(tag);attributes&&$(el).attr(attributes);return el};exports.isElement=function(obj){if(typeof HTMLElement==="object"){return obj instanceof HTMLElement}return obj&&typeof obj==="object"&&obj.nodeType===1&&typeof obj.nodeName==="string"};exports.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};exports.adopt=function(parentElt,_children_){$(parentElt).append(Array.prototype.slice.call(arguments,1))};exports.setStyle=function(elmt,property,value){$(elmt).css(property,value)};exports.stopEvent=stopEvent;exports.mixin=function(target,_mixins_){Array.prototype.slice.call(arguments,1).forEach(function(mixin){for(var prop in mixin){target[prop]=mixin[prop]}},target);return target};exports.merge=function(target,_mixins_){var fromList=Array.prototype.slice.call(arguments,1);for(var i=0,len=fromList.length;i<len;i++){for(var prop in fromList[i]){if(fromList[i].hasOwnProperty(prop)){target[prop]=fromList[i][prop]}}}return target};exports.getFormData=function(form){return formToJson($(form).get(0))};exports.toFormQueryString=function(obj){var qslist=[];if(obj&&obj.nodeName==="FORM"){obj=exports.getFormData(obj)}for(var key in obj){if(obj.hasOwnProperty(key)){var val=obj[key];if(val&&typeof(val)==="object"){for(var i=0;val.length&&i<val.length;++i){var subval=val[i];subval=typeof(subval)==="object"?"":String(subval);qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(subval))}}else{qslist.push(encodeURIComponent(key)+"="+encodeURIComponent(String(val)))}}}return qslist.join("&")};exports.toArray=function(thing){if(typeof thing.length!=="number"){return[thing]}return Array.prototype.slice.call(thing)};exports.throttled=throttle;exports.forceReflow=function(elmt){$(elmt).each(function(idx,elt){elt.offsetWidth})};exports.stripTags=function(str,tag,contents){tag=tag||"";var regstr=contents?"<"+tag+"(?!\\w)[^>]*>([\\s\\S]*?)</"+tag+"(?!\\w)>":"</?"+tag+"([^>]+)?>";return str.replace(new RegExp(regstr,"gi"),"")};return exports});define("utils/ajax",["lib/jquery-amd","ta/Core/TA.Record","api-mod"],function($,taRecord,api){return function(url,options){if(!url.substr){options=url}var newOpts=$.extend({},options,{dataFilter:function(data,type){if(type=="json"){data=data.replace(/^\s*while\s*\([^)]*\);?/,"")}options&&options.dataFilter&&options.dataFilter.call(this,data,type);return data}});newOpts.xhrFields=newOpts.xhrFields||{};newOpts.xhrFields.withCredentials=true;if(api.isElement(newOpts.data)){newOpts.data=api.getFormData(newOpts.data)}var trackEvent=newOpts.trackEvent;if(trackEvent){$.extend(newOpts,taRecord._toEvtParams(trackEvent));newOpts.complete=function(){taRecord._trackEventAfterAjax(trackEvent);options&&options.complete&&options.complete.apply(this,arguments)}}if(newOpts.evalScripts){newOpts.success=function(data,status,xhr){if(data&&data.substr){var dom,scripts;if($.parseHTML){dom=$($.parseHTML(data,document,true));scripts=dom.filter("script").add(dom.find("script"))}else{dom=$("<div>"+data+"</div>");scripts=dom.find("script")}scripts.each(function(idx,script){if(script.innerHTML){if(window.execScript){window.execScript(script.innerHTML)}else{if(window.eval){window.eval(script.innerHTML)}else{var scriptObj=document.createElement("script");scriptObj.setAttribute("type","text/javascript");scriptObj.text=script.innerHTML;document.head.appendChild(scriptObj);document.head.removeChild(scriptObj)}}}})}options&&options.success&&options.success.apply(this,arguments)}}return url.substr?$.ajax(url,newOpts):$.ajax(newOpts)}});define("ta/util/Cookie",["vanillajs","ns-exporter"],function(b,d){var c=0;var e=5000;var a={cookiePIDName:"NPID",ONE_DAY:86400000,ONE_HOUR:3600000,setPIDCookie:function(f){a.write(a.cookiePIDName,f,e,"/",window.cookieDomain)},removePIDCookie:function(){try{a.write(a.cookiePIDName,"",c,"/",window.cookieDomain)}catch(f){}},canSet:function(){document.cookie="SessionTest=true";if(document.cookie.match("(^|;)\\s*SessionTest=true\\s*(;|$)")){document.cookie="SessionTest=; expires=Thu, 01 Jan 1970 00:00:01 GMT";return true}return false},readRaw:function(f){f=f.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1");var g=document.cookie.match(new RegExp("(?:^|;)\\s*"+f+"=([^;]*)"));return g?g[1]:false},remove:function(g,h,f){a.write(g,"",new Date(1000),h,f)},write:function(h,i,g,j,f){if(typeof g=="number"){g=new Date(Date.now()+g)}document.cookie=h+"="+i+(g?"; expires="+g.toUTCString():"")+(j?"; path="+j:"")+(f?"; domain="+f:"")},setOneTimeCookieOnFQDN:function(f,g){a.write(f,g,5000);return true},setOneTimeCookie:function(f,g){a.write(f,g,5000,null,window.cookieDomain);return true}};d.exportTo({setPID:a.setPIDCookie},window);d.createNs(a,"ta.util","cookie");return a});define("ta/util/Error",["vanillajs","api-mod","utils/ajax","ns-exporter","mixins/Events","utils/browserutils","ta/util/Cookie"],function(p,o,n,t,m,b,l){var x={};var k=new m("error","beforeSend");var e=window.IS_DEBUG;var c=3000;var j=e?100:10;var q=4;var g="unset";var h=0;var i=false;x.record=function(R,z,L,N,H,G){G=G||{};if(!R){R=new Error("Stub error to build stack.")}else{if(typeof R=="string"){R=new Error(R)}}var M=false;try{var A=Object.prototype.toString.call(R);M=A===Object.prototype.toString.call(new Error)||A.match(/\[object Error[\w]*]/)}catch(U){}if(M&&!R.stack){try{throw (R)}catch(U){if(U&&U.stack){R=U}}}L=L||window.event||{};var W=L.target;if(h>=j){if(e){console.error("Maximum JS errors reached. Not reporting.")}return}h++;var J=false;try{J=document.body.className.match(/\bjs_logging\b/)||r()}catch(U){}if(!J){return}var X=true;if(N&&N.hasOwnProperty("error_script")&&!d(N.error_script)&&!s(N.error_script)){X=false}var F={};if(W){try{F.eTarg=x.getSelectorString(W)}catch(K){}}if(typeof(debugCacheKey)!="undefined"){F.key=debugCacheKey}var y=window.pageServlet;if(!y){y="unknown"}F.servlet=y;if(!H||typeof H!="string"){H="ERROR"}if(!X){H="WARN";F.warnReason="externalError"}else{if(!IS_DEBUG&&h>1){H="WARN";F.warnReason="notFirstJSError"}}var aa={extraInfoError:"Problem storing extra info"};var E={};try{var D="";var C="";if(W){if(typeof W.id!=="function"){D=W.id}C=W.className}var S=window.serverPool||"";var P="";if(window.MooTools){P+="MooTools "}if(require.defined("lib/jquery-amd")){P+="jQuery "}E={TARGET_ID:D,TARGET_CLASS:C,PAGE_UID:ta.uid,INTERNAL_JS:f(),CLIENT_POOL:S,COOKIES_ENABLED:l.canSet(),JS_LIBS:P};if(!X){E.INTERNAL_ERROR="false"}if(h>1){E.PRIOR_JS_PAGE_ERRORS=h-1}}catch(T){N=aa}F.xInfo=v(E,N);try{F.eUrl=window.location.href}catch(K){}var I="No Error";try{if(M){I=R.name+"-"+R.message}else{if(typeof R==="object"){if(R.name&&R.message){I=R.name+"-"+R.message}else{I="non-Error object "+Object.prototype.toString.call(R)+" passed, sample properties - ";var Y=0;for(var B in R){if(R.hasOwnProperty(B)){I+=B.substring(0,30)+": "+(R[B]&&R[B].toString?R[B].toString().substring(0,20):R[B])+", ";if(++Y>4){break}}}}}else{I="non-Object error passed: "+(""+R).substring(0,60)}}I=I.replace(/[\r\n]/g,"")}catch(K){}F.eMsg=I;try{F.eBlk=w(z).substring(0,150)}catch(K){}var Z;if(!R.stack){try{Z=(L&&L.callee)||(arguments&&arguments.callee)}catch(U){}}var V=u(R,W,Z);if(V){F.eStak=V}try{k.emit("beforeSend",F)}catch(K){}F.eLogLevel=H;a(F);if(e&&!G.isglobal){console.error("/JSErrorRecord:");if(R.stack){console.error(R.stack)}else{if(V){console.error(V)}else{console.error("No stack")}}}try{n({url:"/JSErrorRecord",data:F,method:"POST",type:"POST"})}catch(U){F={eBlk:"JSErrorRecord Error",servlet:y,eLogLevel:"ERROR",eMsg:"no error retrieved"};n({url:"/JSErrorRecord",data:F})}if(e){(window.ERRORS||(window.ERRORS=[])).push(F)}k.emit("error",I,z,H,F.eStak);if(g=="unset"){g=l.readRaw("JS_ERROR_HANDLING")}if(g){if(g.match(/alert/)){var O="";for(var Q in F){if(F.hasOwnProperty(Q)){O=O+Q+": "+F[Q]+"\n"}}alert(O)}if(g.match(/console/)){if(window.console){console.error(F)}}}};x.getSelectorString=function(z){for(var y=[];z&&z.tagName!="HTML"&&z!=document;z=z.parentNode){var A=z.tagName;if(z.id){A+="#"+z.id}if(z.className){A+="."+z.className.trim().replace(/\s+/g,".")}y.unshift(A)}return y.join(">")};x.ajaxFailure=function(A,z,y,B){x.record(null,A,null,o.merge({status:z.status},y),B||"ERROR")};x.enableDomReadyParam=function(){i=true};x.on=k.on.bind(k);x.off=k.off.bind(k);function v(G,y){var D="_extraInfoError_:Problem storing extra info.";var F={};var H="";try{if(Array.isArray(y)||(Object.prototype.toString.call(y)==="[object Arguments]")){var A={};for(var C=0;C<y.length;C++){var z=y[C];var E=typeof z;if(E==="string"||E==="number"||E==="boolean"){A[C]=z}else{A[C]=E}}y=A}o.merge(F,G,y)}catch(B){F=G}try{H=JSON.stringify(F);if(H){if(H.length>c){H=H.substring(0,c)}return H.replace(/[\r\n]/g,"")}}catch(B){}return D}function w(y){if(typeof y!="undefined"&&y!==null){return y.toString().replace(/[\r\n]/g,"")}return"null or undefined"}function u(L,S,T){var E,N="";if(L&&L.stack){try{var J=L.stack.split("\n");var B=[];var C;var H;var y=0;if(J[1]&&J[1].match(/\.record /)){J.splice(1,1)}for(var D=0;D<J.length;D++){var F=J[D];if(F.indexOf(L.message)>=0){continue}var Q=!!F.match(/\/jquery-|\/mootools|\(native\)|\(native code\)|\[native code]/);F=F.replace(/^(.*)http.+\/([^\/]*)/,"$1$2").replace(/(\?.{20})[^:)]+/,"$1...").replace(/^(?:\s+\w+\s*([^\s]+)|([^\s]+)@)\s*\(?([^)]*)\)?$/,"$1$2 ($3)").replace(/\s*\(\)/,"");if(!C||!Q){B.push(F);if(Q){y++}}else{if(!H){B.push("...");H=true;y++}}if(!Q){H=false}C=Q}if(B.length-y<=q){E=true}N=B.join()}catch(P){if(e){console.error("Debug: error.stack handler failed ");console.error(P)}}}if(!N&&T){try{var K=[];var O=T.caller;var A=0;while(O&&A++<20){var z=O.toString();var R=z.replace(/^function\s+([^(\s]+).*/,"$1")||"anonymous";if(!R.match(/onErrorFunc|_getErrorStack/)){var I=Math.min(z.length,100);var G=z.substring(0,I).replace(/(\n|\r|\'|\")/g," ");K.push(G)}O=O.caller}if(K.length<5){E=true}N=K.join(" :: ")}catch(P){if(e){console.error("Debug: exception getting callee stack "+P)}}}if(!N&&L&&L.filename){N=L.filename.replace(/^.*\/([^/]+)$/,"$1");if(L.lineno){N+=":"+L.lineno}if(L.colno){N+=":"+L.colno}}if(S&&E){var M=x.getSelectorString(S);if(M){if(N){N+=", "}N+="DOM_STACK: "+M}}return N?N:"failed to get stack"}function f(){var y=[];[].forEach.call(document.getElementsByTagName("script"),function(A){var z=A.src;if(d(z)){y.push(z.substring(z.indexOf("/js")+1))}});return y.join(", ").substring(0,c)}function d(y){if(!y||!y.indexOf){return false}var z=window.CDNHOST||"";if(e&&z==""){return y.match(/(js3\/|js\/)/)!=null}else{return y.indexOf(z)==0}}function s(z){if(!z||!z.indexOf){return false}var y="noPage";try{y=window.location.href}catch(A){}return z===y}function r(){var z=(b.Platform.ios||b.Platform.android)&&!window.isTabletOnFullSite;var y=document.cookie.indexOf("TAmobilemode=main")>=0;return z&&!y}function a(A){if(r()){var B={eMsg:"msg",eStak:"stack",eUrl:"url"};for(var y in B){var z=B[y];A[z]=A[y]}A.file=A.url||document.URL;A.site=window.SITE_VERSION;A.loaded=i?"dom_ready":"not_loaded"}}if((b.firefox&&b.version<5)||(b.ie&&b.version<8)){x.record=function(){if(window.console){console.error("Unreported error: "+[].slice.call(arguments).join(", "))}}}t.createNs(x,"ta.util","error");return x});define("utils/resourceLoader",["vanillajs"],function(c){var d={};var a={};function e(){var i,k,f;this.load=function(q,m,r){if(typeof m==="function"){r=m;m={}}i=0;k=b(q||null);r=r||function(){};m=m||{};f=m.serial;if(k.length==0){setTimeout(r,1)}else{if(f){var p=k.slice();var o;var n=function(s){o=o&&s;if(p.length==0){r&&r(o)}else{l(n,m.forceType,p.shift())}};n()}else{k.forEach(l.bind(null,r,m.forceType))}}};function g(){try{if(navigator.userAgent.match(/ Safari[/]/)&&!navigator.userAgent.match(/ Chrom/)&&navigator.userAgent.match(/ Version\/5\./)){return false}var n=navigator.userAgent.match(/\ AppleWebKit\/(\d+)\.(\d+)/);if(n){n.shift();var m=parseInt(n[0]),o=parseInt(n[1]);if(m<535||(m==535&&o<23)){return false}}return"onload" in document.createElement("link")}catch(p){return false}}function j(m,o,n){i++;(i==k.length||f)&&o(n);if(n){if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(m),"utils/resourceLoader: failed to load file ["+m+"]")}}else{d[m]=1}}function h(m){if(m.match(/\.css$/)){return"css"}else{if(m.match(/\.js$/)){return"js"}}return""}function l(t,r,o){var q=r||h(o);if(q){var s,p,m;if(q=="css"){s=document.createElement("link");s.rel="stylesheet";s.type="text/css";m="href";p=g()}else{if(q=="js"){s=document.createElement("script");s.type="text/javascript";m="src";p="onload" in s}}if(p){s.onload=j.bind(null,o,t,false);if("onerror" in s){s.onerror=function(){if(a[o]){j(o,t,true)}else{a[o]=true;l(t,r,o)}}}}else{j(o,t,false)}s[m]=o;var n=document.getElementsByTagName("head")[0];n.appendChild(s)}else{if(require.defined("ta/util/Error")){require("ta/util/Error").record(new Error(o),"utils/resourceLoader: unknown file type for ["+o+"]")}j(o,t,true)}}}function b(h){var g=[];var f=function(i){if(i&&!(i in d)){if(i&&i.splice){i.forEach(f)}else{g.push(i)}}};f(h);return g}return{Loader:e,load:function(g,f,h){if(typeof f==="function"){h=f;f={}}(new e()).load(g,f,h)},loaded:function(f){return b(f).length==0}}});define("ta/Core/TA.Load",["vanillajs","ns-exporter","ta/Core/TA.Store","utils/resourceLoader"],function(c,d,f,b){var a={};a.load=function(i,n,m){var l=false;var j=e(i);if(j){l=VERSION_MAP[j]}var h=function(){var o=f.remove(g);o&&o.forEach(function(p){if(p){p()}})};if(l){var g=j+"_callback";if(f.has(g)){var k=f.retrieve(g);k.push(n);f.store(g,k)}else{f.store(g,[function(){delete VERSION_MAP[j];if(n){n()}}]);if(typeof l==="object"){b.load(l,{serial:true,forceType:"js"},h)}else{b.load(l,{forceType:"js"},h)}}}else{if(m&&b.loaded(l)){h();n&&n()}}return l};a.loadInOrder=function(g,h){b.load(g,{serial:true},h)};function e(k){if(typeof k!="string"||!VERSION_MAP){return}var i=false;if(VERSION_MAP[k]){i=k}else{if(VERSION_MAP[k+".js"]){i=k+".js"}else{var g=k.split(".");var h=0;while(g&&g.length>1&&h<10){g=g.slice(0,-1);var j=g.join("-")+".js";if(j&&VERSION_MAP[j]){i=j;break}h++}}}return i}d.exportTo(a,"ta");return a});define("ta/Core/TA.Event",["vanillajs","ta/util/Error","ta/Core/TA.Load","ns-exporter"],function(vanilla,taError,taLoad,nsExporter){var exports={};var _eventListeners={};exports.call=function(funcName,evnt,elmt,_varargs_){if(evnt==null){if(IS_DEBUG){alert("You must pass the event.\n\nUsage:\nta.call('ta.namespace.Class.function', event);")}return false}if(funcName==null){if(IS_DEBUG){alert("ta.call of undefined function")}return false}var func=funcName;if(typeof(funcName)==="function"){funcName="<func>"}else{if(!/^ta\.[\w\d\.]+$/.test(funcName)){if(IS_DEBUG){alert("Invalid function name. Must be of the form: ta.namespace.Class.function")}return false}}var e=evnt||window.event;["stopPropagation","preventDefault"].forEach(function(name){if(!e[name]){e[name]=function(){}}});if(!e.stop){e.stop=function(){e.preventDefault();e.stopPropagation()}}if(!elmt){elmt=e.target||e.srcElement}if(!elmt){taError.record(null,"ta.call re-wrap fail (non-DOM element) - "+funcName,evnt,{elmtArg:taError.describe({none:"none"}),funcName:funcName})}var argSet=arguments;var args=Array.prototype.slice.call(argSet,3);args.splice(0,0,e,elmt);try{args.unshift({callback:_ta_call_defer,evt:e});args.unshift(func);return exports.run.apply(null,args)}catch(_ex){taError.record(_ex,"ta.call - "+funcName,evnt)}return false};var _ta_call_defer=function(func,options){if(options){delete (options.evt)}exports.run.apply(null,arguments)};exports.run=function(func,options){var argSet=arguments,args=Array.prototype.slice.call(argSet,2);try{var fn=exports.fn(func);if(typeof fn=="function"){var retVal=fn.apply(window,Array.prototype.slice.call(args));if(options&&options.onComplete){var completeFun=exports.fn(options.onComplete);if(completeFun){completeFun(retVal)}}return retVal}else{if(options&&options.evt){if(options.evt.stopPropagation){options.evt.stopPropagation()}else{options.evt.cancelBubble=true}if(options.evt.preventDefault){options.evt.preventDefault()}else{options.evt.returnValue=false}}}var callback=options&&options.callback;taLoad.load(func,(callback||exports.run).pass(arguments))}catch(_ex){taError.record(_ex,"ta.run - "+func)}return false};exports.on=function(name,f){var v=_eventListeners[name];if(!v){v=_eventListeners[name]=[]}v.push(f)};exports.fireEvent=function(name,_varargs_){var args=Array.prototype.slice.call(arguments),listeners=_eventListeners[name];args.shift();if(listeners){listeners.slice(0).forEach(function(callback){try{callback.apply(null,args)}catch(e){}})}};exports.off=function(name,f){if(f){var v=_eventListeners[name],index;if(v instanceof Array){index=v.indexOf(f);if(index>=0){v.splice(index,1)}}}else{delete _eventListeners[name]}};function QueueTimer(evtName,after){var m_timer=0;var m_totalTime=0;var m_data=[];var m_start=0;var m_done=false;this.start=function(){m_timer&&clearTimeout(m_timer);m_start=Date.now()};this.end=function(name){var now=Date.now();var duration=now-m_start;m_totalTime+=duration;var out=""+duration+"ms ["+(name||"")+"]";var outEvt=evtName+(after?"-after":"");if(m_done){console.error("Straggler for "+outEvt+": "+out)}else{m_data.push(out);m_timer=setTimeout(function(){console.error("Timing for "+outEvt+": "+m_totalTime+"ms\n"+m_data.sort(function(a,b){return parseInt(a)-parseInt(b)}).join("\n"));m_done=true},2000)}}}var OneTimeFunctionQueue=function(evtName,after,runNow){var _queue=[];var _runNow=!!runNow;var _timing;var _execFn=function(fn,name){_timing&&_timing.start();try{fn()}catch(_ex){try{taError.record(_ex,"OneTimeFunctionQueue "+evtName+(after?"-after":"")+(name?"-"+name:""))}catch(ignore){}}_timing&&_timing.end(name)};var _runQueuedFunctions=function(){_queue.sort(function(a,b){return(a.priority-b.priority)||(a.subpriority-b.subpriority)});if(after){var delay=1;_queue.forEach(function(item){setTimeout(_execFn.bind(null,item.func,item.name),delay++)})}else{_queue.forEach(function(item){_execFn(item.func,item.name)})}_queue=[]};if(evtName!=null){function onListener(){_runNow=true;_runQueuedFunctions()}if(window.addEventListener){window.addEventListener(evtName,onListener,false)}else{if(window.attachEvent){if(evtName=="DOMContentLoaded"){window.attachEvent("onload",onListener)}else{if(evtName=="load"){window.attachEvent("on"+evtName,function(){setTimeout(onListener,1)})}else{window.attachEvent("on"+evtName,onListener)}}}}}this.addToQueue=function(fn,priority,name){if(!fn){taError.record(null,"addToQueue for "+evtName+" queue - no function");return}if(typeof priority==="string"){name=priority;priority=false}if(_runNow){_execFn(fn,name)}else{priority=priority||(100+_queue.length);_queue.push({func:fn,priority:priority,name:name,subpriority:_queue.length})}};this.executeQueue=function(){_runQueuedFunctions()}};var loaded=typeof document!=="undefined"?document.readyState==="complete":false;var ready=(typeof document!=="undefined"?document.readyState==="interactive":false)||loaded;var _readyQ=new OneTimeFunctionQueue("DOMContentLoaded",false,ready);var _loadQ=new OneTimeFunctionQueue("load",false,loaded);var _afterLoadQ=new OneTimeFunctionQueue("load",true);if(!ready){_loadQ.addToQueue(function(){_readyQ.executeQueue()},-999999999,"checkReadyQueue")}_loadQ.addToQueue(function(){_afterLoadQ.executeQueue()},999999999,"afterLoadQueue");exports.queueForReady=function(fn,priority,name){_readyQ.addToQueue(fn,priority,name)};exports.queueForLoad=function(fn,priority,name){_loadQ.addToQueue(fn,priority,name)};exports.queueForAfterLoad=function(fn,name){_afterLoadQ.addToQueue(fn,0,name)};exports.hasEventListener=function(name){return !!(_eventListeners[name])};exports.fn=function(fn){switch(typeof(fn)){case"function":return fn;case"string":var f=false;try{f=eval(fn)}catch(e){}if(!f){var ns=fn.split("."),n=ns.pop();try{ns=eval(ns.join("."));f=ns&&ns._magic&&ns._magic.partial(n)}catch(e){}}if(f&&typeof(f)==="function"){return f}break}return null};exports.fireClick=function(node){if(document.createEvent){var evt=document.createEvent("MouseEvents");evt.initEvent("click",true,false);node.dispatchEvent(evt)}else{if(document.createEventObject){node.fireEvent("onclick")}else{if(typeof node.onclick==="function"){node.onclick()}}}};exports.throttle=function(callback,uniqueKey,minDelay,maxDelay){var now=(new Date()).getTime();var obj;if(uniqueKey in m_throttles){obj=m_throttles[uniqueKey];if(now-obj.lastReset<obj.minResolution){obj.cb=callback;return}}else{obj=m_throttles[uniqueKey]={start:now,minResolution:Math.max(Math.floor(minDelay/10),50)}}obj.cb=callback;function doIt(){delete m_throttles[uniqueKey];obj.cb()}if(obj.timeout){clearTimeout(obj.timeout)}if(maxDelay&&(now-obj.start>maxDelay)){doIt()}else{obj.lastReset=now;obj.timeout=setTimeout(doIt,minDelay)}};var m_throttles={};nsExporter.exportTo(exports,ta);return exports});require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"hr_top_right_cta_first_chevron_hsx","handlers",["handlers"]);t(["placement","lib/jquery-amd","commerce/offerclick","ta","ta/Core/TA.Record","ta/Core/TA.Event","ta/util/Error"],function(e,t,a,n,o,r,i){function c(){C=t("#"+e.id),T=t(".hr_top_right_cta_pre .crButton"),f=t(".hr_top_right_cta_pre .calendarFlyout"),E=t(".hr_top_right_cta_pre"),O=t(".hr_top_right_cta_post"),A=C.find(".btnWrap .ui_button.original")}function l(e){c(),C.length&&(E.addClass("hidden"),C.html(e.outerHTML),o.trackEventOnPageOnce("NAV_RIGHT_CTA","POST_SHOWN",""))}function p(){require(["overlays/Overlay","overlays/styles/tooltip","overlays/position","overlays/options/closeOnDocClick","overlays/options/closeOnScroll","overlays/options/closeOnEscape","overlays/options/centerArrowOnSrcElement"],function(e,t,a,n,o,r,i){T&&f&&(v=new e(T.get(0),t(T.get(0),"below","light",f.get(0)),a.bottomLeft(),n,r,o,i(T.get(0))),v.on("hide",function(){y=!1}))})}function s(e){if(n.page&&f&&v){var a=n.page.hasDates("CHECKIN")?"CHECKOUT":"CHECKIN",o=t("[data-dateType="+a+"]",f).get(0),r=t(".calendarWrapper",f).get(0);o&&r&&(r.overlay=v,n.page.gatherDates(o,r),v.show(),y=!0,h(e,"open_calendar"))}}function d(e,a,r){if(("STAYDATES"===a||"CHECKIN"===a||"CHECKOUT"===a)&&r&&y){if("STAYDATES"===a)return v.hide(),E.addClass("hidden"),void o.trackEventOnPage("NAV_RIGHT_CTA","DATES_ENTERED","");var i="CHECKIN"===a?"CHECKOUT":"CHECKIN",c=t("[data-dateType="+i+"]",f).get(0),l=t(".calendarWrapper",f).get(0);(c||l)&&n.page.gatherDates(c,l)}}function g(t,n,o){var r=n.getAttribute("data-clickToken");r?a.clickEvent(t,n,r):i.record(null,e.name+" missing click token."),o&&h(t,o)}function _(e,a){e&&e.stopPropagation&&e.stopPropagation(),t(a).hide().nextAll().removeClass("hidden")}function u(e){if(e){var a=t(".upTicker",e);a.hasClass("anu")||a.toggleClass("animateFlipChevron")}}function h(e,t){e&&e.stopPropagation&&e.stopPropagation(),o.trackEventOnPage("NAV_RIGHT_CTA","click",t)}var C,v,T,f,E,O,A,y=!1;return c(),n.page.on("doc-hide",u),n.page.on("hide",u),T&&(r.queueForLoad(p,"calendar flyout overlay"),r.queueForLoad(function(){o.trackEventOnPage("NAV_RIGHT_CTA","PRE_SHOWN","")},"pre-date tracking"),n.page&&n.page.on&&n.page.on("dateSelected",d)),O&&o.trackEventOnPageOnce("NAV_RIGHT_CTA","POST_SHOWN",""),r.on("update-"+e.name,l),{openCalendarFlyout:s,clickOffer:g,expandMoreDropdown:_,animateChevronFlip:u}})});define("utils/localstorage",["vanillajs"],function(l){var p=false,f="taLsTest",d="1",j=Date.now()+":"+a();function q(s){return k(s,"value")}function o(s){return k(s,"now")}function k(s,u){if(!u){return null}try{var t=JSON.parse(p.getItem(s)||"0");if(!t){return null}if(t.ttl&&t.ttl+t.now<new Date().getTime()){p.removeItem(s);return null}if(!t.hasOwnProperty(u)){return null}return t[u]}catch(v){}return null}function g(s){try{p.removeItem(s)}catch(t){}}function e(s){try{var u=p.getItem(s);if(u!==null&&u!==undefined){return true}}catch(t){}return false}function h(t,u,s){try{p.setItem(t,JSON.stringify({ttl:s||0,now:new Date().getTime(),value:u}))}catch(v){}}function i(){var t=false;try{if(p&&p.setItem){p.setItem(f,d);t=p.getItem(f)!=d;p.removeItem(f);if(t){p=false}return !!p}}catch(s){}return false}function n(s){p=s;this.enabled=i()}function a(){return Math.random()*1000000000|0}function b(w,y,u){var v=w+"__MUTEX_x",s=w+"__MUTEX_y",t=function(){return q(s)};function x(){try{y()}finally{g(s)}}h(v,j);if(t()){if(!u){setTimeout(function(){b(w,y)},0)}return false}h(s,j,40);if(q(v)!==j){if(!u){setTimeout(function(){if(t()!==j){setTimeout(function(){b(w,y)},0)}else{x()}},50)}return false}else{x();return true}}function m(u,t,s,v){return function(){try{v()}finally{b(u,function(){if(q(t)!==s){throw u+" was locked by a different process while I held the lock"}g(t)})}}}function r(y,z,u,s){u=u||5000;var v=y+"__MUTEX",w=function(){return q(v)},A=j+":"+a(),B=function(){setTimeout(function(){r(y,z,u)},10)};if(w()){if(!s){B()}return false}var x=m(y,v,A,z);var t=b(y,function(){if(w()){if(!s){B()}return false}h(v,A,u);if(!s){setTimeout(x,0)}},s);if(s&&t){x();return true}return false}function c(){var t=false;try{if(window&&window.localStorage){t=window.localStorage}}catch(s){}n(t)}c();return{enabled:i(),get:q,set:h,remove:g,has:e,getTimeStamp:o,setStorage:n,lock:function(s,u,t){r(s,u,t,false)},attemptLock:function(s,u,t){return r(s,u,t,true)}}});require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"photoviewer","autoplay",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);t(["lib/jquery-amd","ta/Core/TA.Event","utils/localstorage"],function(e,t,a){function n(e){p!==e&&(p=e,a.set(i,e),t.fireEvent(l,e))}function o(){return p}function r(){var e=a.get(i);return"boolean"==typeof e?e:u}var i="photoviewer.autoplayEnabled",l="photoviewer.autoplayChanged",u=!0,p=r();return e(window).on("storage",function(e){if(e.key===i){var a=r();a!==p&&(p=a,t.fireEvent(l,p))}}),{setAutoplayEnabled:n,isAutoplayEnabled:o,AUTOPLAY_EVENT:l}})});require(["ta/p13n/placements"],function(a){var t=a.define.bind(a,"photoviewer","autoplayOverlay",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);t(["lib/jquery-amd","ta/Core/TA.Event","autoplay"],function(a,t,e){function r(a,r){d=a,p=r,t.on(e.AUTOPLAY_EVENT,function(){var a=e.isAutoplayEnabled(),t=l();a&&!t&&p.onVideoComplete(),!a&&t&&i()})}function n(t){if(e.isAutoplayEnabled()){var r=u(t);if(r){c=a.extend({},r.params,{autoplay:!0});var n=a("#AUTOPLAY-OVERLAY",d);n.css("background-image","url("+r.previewUrl+")");var i=a("#AUTOPLAY-OVERLAY-TITLE",n);i.text(r.title);var l=a(".progressIndicator",n),s=2*l.attr("r")*Math.PI;l.stop(),l.css("stroke-dasharray",s),l.css("stroke-dashoffset",s),l.animate({"stroke-dashoffset":0},f,"linear",o),n.show()}}}function i(){var t=a("#AUTOPLAY-OVERLAY",d);t.hide(),c=null}function l(){return a("#AUTOPLAY-OVERLAY",d).is(":visible")}function o(){l()&&c&&(p.loadData(c),i())}function s(){l()&&c&&(e.setAutoplayEnabled(!1),i())}function u(t){var e=a('.tinyThumb[data-mediaid="'+t+'"]',d);if(0===e.length)return null;var r=parseInt(e.attr("data-offset"))+1,n=a('.tinyThumb[data-offset="'+r+'"]',d);if(0===n.length)return null;var i=a("a",n).attr("data-href");return i?{title:n.attr("data-captiontext"),previewUrl:n.attr("data-bigurl"),params:i.parseQueryString(!1,!1)}:null}var d,p,f=1e4,c=null;return{init:r,openOverlay:n,closeOverlay:i,isOverlayOpen:l,play:o,cancel:s}})});define("amdloaders",["vanillajs"],function(){var j=[],u=[],v=[],l=[];var h=[];var d=null,B=null,E=null;var s={};var F={};var g={};var w={};var A=null;var r=false;var c=false;var i={};var q=function(G,H,I){if(!s[G]){s[G]=true;u.push(G)}h.push(function(J){if(!J&&H.parsed&&!H.parsed(G)){J=new Error("Dynamic load failed to define module '"+G+"'")}if(J&&I.error){I.error(J)}});D()};var p=function(G,H,I){if(!s[G]){s[G]=true;if(!F[G]&&!H.specified(G)){u.push(G)}}h.push(function(J){var K=H.specified(G);if(!J&&!F[G]&&!K){J=new Error("Dynamic load failed to define '"+G+"'")}if(J){if(I.error){I.error(J)}}else{if(K){H([G],I,I.error)}else{I(true)}}});D()};var a=function(G,H,I){j.push(G);h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var t=function(G,H,I){v.push(G);h.push(function(J){if(!J&&!H.specified("trhtml!"+G)){J=new Error("Dynamic load failed to define content '"+G+"'")}if(J){if(I.error){I.error(J)}}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var n=function(G,H,I){if(!g[G]){g[G]=true;if(!w[G]){l.push(G)}}h.push(function(J){if(J){if(I.error){I.error(J)}}else{I(true)}});D()};var D=function(){if(!A&&r&&!c&&(h.length||j.length||u.length||v.length||l.length)){A=setTimeout(z,0)}};var b=function(J,I){var G=J.getAttribute("data-rup");if(!G){return}var K;G=G.split(",");for(var H=0;H<G.length;H++){K=G[H].trim();if(K){I(K)}}};var x=i.getJSRollupsLoaded=function(){var I,H;var G=B;if(!G){G=[];H=document.getElementsByTagName("SCRIPT");if(H){for(I=0;I<H.length;I++){if(!H[I].hasAttribute("data-is-dust")){b(H[I],function(J){G.push(J);s[J]=true})}}}}return G};var m=i.getCSSRollupsLoaded=function(){var I,H;var G=d;if(!G){G=[];H=document.head&&document.head.getElementsByTagName("LINK");if(H){for(I=0;I<H.length;I++){b(H[I],function(J){G.push(J)})}}}return G};var e=i.getLoadedFilesParams=function(){return{haveJses:String(x()),haveCsses:String(m())}};var z=function(){A=null;if(!r||c){return}var L,J,G;var O=[],I=j,H=h,M=v,R=l;for(L=0;L<u.length;L++){G=u[L];if(G&&!F[G]&&!require.parsed(G)){O.push(G)}}h=[];j=[];u=[];v=[];l=[];if(!d){d=m()}if(!B){B=x()}if(!O.length&&!I.length&&!M.length&&!R.length){o(H);return}var K="haveJses="+encodeURIComponent(String(B))+"&haveCsses="+encodeURIComponent(String(d))+"&needJses="+encodeURIComponent(String(O))+"&needCsses="+encodeURIComponent(String(I))+"&needDusts="+encodeURIComponent(String(R));if(M.length>0){K+="&needContent="+encodeURIComponent(String(M))}if(window.pageServlet){K+="&metaReferer="+encodeURIComponent(window.pageServlet)}var U=null;try{U=new XMLHttpRequest()}catch(T){try{U=new ActiveXObject("MSXML2.XMLHTTP")}catch(S){try{U=new ActiveXObject("Microsoft.XMLHTTP")}catch(Q){throw new Error("Can't create XMLHttpRequest or similar")}}}var N=false;U.onreadystatechange=function(){if(!N&&U.readyState===4){N=true;if(U.status>=200&&U.status<=299){k(H,U.responseText)}else{o(H,new Error("XHR returned "+U.status))}}};U.open("POST","/DemandLoadAjax",true);try{U.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=utf-8")}catch(P){}try{U.setRequestHeader("X-Requested-With","XMLHttpRequest")}catch(P){}try{U.setRequestHeader("Accept","text/html, */*")}catch(P){}c=true;U.send(K)};var o=function(H,G){c=false;D();if(!H.length){return}for(var I=0;I<H.length;++I){try{H[I](G)}catch(J){window.IS_DEBUG&&console.error&&console.error("Error in async callback: ",J)}}};var k=function(P,N){var M,O;var J=[];try{if(!(N&&N.substr)){throw new Error("no data returned from /DemandLoadAjax")}var G=document.createElement("DIV");G.innerHTML=N;var K=G.querySelectorAll("STYLE, LINK");var T=[];for(O=0;O<K.length;O++){T.push(K[O])}K=T;T=document.createDocumentFragment();for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){d.push(U);define("trcss!"+U,[],C(H))});T.appendChild(I)}document.head.appendChild(T);K=G.getElementsByTagName("SCRIPT");var L=[];for(O=0;O<K.length;O++){var I=K[O];b(I,function(U){if(I.hasAttribute("data-is-dust")){w[U]=true}else{B.push(U);F[U]=true}});var S=document.createElement("script");S.setAttribute("type","text/javascript");S.setAttribute("data-rup",I.getAttribute("data-rup"));if(I.src){S.src=I.src;S.async=true;J.push(S)}else{if(I.text){S.text=I.text;document.head.appendChild(S);document.head.removeChild(S)}}}var H,Q;while((H=G.firstChild)){G.removeChild(H);if(H.nodeType===1){Q=H.getAttribute("data-content");if(Q){define("trhtml!"+Q,[],C(H))}}}}catch(R){M=R}if(J.length>0){y(J,P,M)}else{o(P,M)}};var C=function(G){return function(){return G}};var y=function(G,I,K){var J,H,M=0;var L=function(){if(--M===0){o(I,K)}};for(J=0;J<G.length;J++){H=G[J];if(H){H.onload=L;H.onerror=L;M+=1}}if(M<=0){o(I,K)}else{for(J=0;J<G.length;J++){H=G[J];if(H){document.head.appendChild(H)}}}};var f=i.activate=function(){if(!r){r=true;if(!define.depLoader||define.depLoader.isDefault){define.depLoader=q}D()}};define("trjs",[],function(){return{load:p}});define("trcss",[],function(){return{load:a}});define("trhtml",[],function(){return{load:t}});define("trdust",[],function(){return{load:n}});if(document.addEventListener&&!window.taRollupsAreAsync){document.addEventListener("DOMContentLoaded",f,false)}if(window.addEventListener){window.addEventListener("load",f,false)}else{if(window.attachEvent){window.attachEvent("onload",f)}}return i});define("ta/prwidgets",["vanillajs","ns-exporter","purify","amdloaders"],function(i,q,b,j){var t={};var e=define;var l=require;var m={};var s=/\bhandlerLoading *\b/g;var o;t.define=function(y,x,A,u,z){x=x.replace(/\.js$/i,"");if(Object.prototype.toString.call(u)!=="[object Array]"){u=[]}if(A&&A.length){var w=m[y];if(!w){m[y]=w={}}for(var v=0;v<A.length;v++){w[A[v]]=true}}e("$prw/"+y+"/"+x,n(y,u),function(){var B=Array.prototype.slice.apply(arguments);return function(C){if(!C[x]){C[x]=z.apply(null,h(C,u,B))}return C[x]}})};t.redefine=function(v,u){if(l.undef){l.undef("$prw/"+v+"/"+u)}return t.define.apply(this,arguments)};function d(u,y){var v,x;var w=this.element._prWidgetContext;if(typeof u==="string"){u=[u];v=n(w.widget.name,u);v=v[0]&&l(v[0]);v=v&&h(w,u,[v]);return v&&v[0]}u=u.slice();l(n(w.widget.name,u),function(){var z=h(w,u,arguments);y&&y.apply(null,z)})}function n(A,z,y){var x=m[A];if(!x){return[]}z=z.slice();for(var w=0;w<z.length;++w){var v=z[w];var B=v.replace(/^[a-z]+!/,"");var u=v.substring(0,v.length-B.length);if(u==="trhtml!"){}else{if(B==="widget"){z[w]=null}else{if(x[u==="trjs!"?B:v]){z[w]=u+"$prw/"+A+"/"+B}}}}return z}function h(x,z,v){var u,w;v=Array.prototype.slice.apply(v);if(z.length===0){return v}var y=m[x.widget.name];if(v.length<z.length){u=n(x.widget.name,z);while((w=v.length)<z.length){if(u[w]){v.push(l(u[w]))}else{v.push(null)}}}for(var w=0;w<z.length;++w){var A=z[w].replace(/^trjs!/,"");if(x[A]){v[w]=x[A]}else{if(y[A]&&(typeof v[w])==="function"){v[w]=v[w].call(null,x)}}}return v}t.getjs=function(v,w){var u=k(v);if(u&&(typeof w==="string")){return u.widget.require(w)}};t.initWidgets=function(u,x){var w,v;if(!u){u=document}if(typeof(u)==="string"){u=document.getElementById(u);if(!u){return}}if(!x){u=b(u,true);if(u.forEach){u.forEach(function(y){t.initWidgets(y,true)});return}}w=u.querySelectorAll(".prw_rup");for(v=0;v<w.length;v++){p(w[v])}w=u.querySelectorAll(".prw_dyn");for(v=0;v<w.length;v++){p(w[v])}};function r(u){u._prWidgetContext=this.element._prWidgetContext}function p(w){var x,C,u,y,v,B;if(!w){return}if(w._prWidgetContext){return}x=w.getAttribute("data-prwidget-init");if(typeof(x)!="string"){return}u=w.getAttribute("data-prwidget-name");if(!u){return}x=c(x);v=c(w.getAttribute("data-scriptFlags")).reduce(function(E,D){E[D]=true;return E},{});var z=x.length;B=w.getAttribute("data-prwidget-deferred");if(B){B=c(B);for(var y=0;y<B.length;y++){x.push(B[y])}}var A=m[u];if(!A){m[u]=A={}}C={};for(y=0;y<x.length;y++){A[x[y]]=true}C.widget={name:u,element:w,modules:x,flags:v,markMine:r,require:d};w._prWidgetContext=C;C.widget.require(x.slice(0,z),function(){if(w._prPendingClick){var D=w._prPendingClick;w._prPendingClick=void (0);if(D.key===o){window.setTimeout(function(){t.call.apply(t,D.args)},0)}}})}function c(u){if(typeof u!=="string"){return[]}return u.match(/[^\s,]+(\s+[^\s,]+)*/g)||[]}function k(v){var u=v._prWidgetContext;if(u){return u}for(v=v.parentNode;v&&v.hasAttribute;v=v.parentNode){u=v._prWidgetContext;if(u){return u}if(v.hasAttribute("data-prwidget-init")){break}}return}function g(v){for(var u=v;u&&u.hasAttribute;u=u.parentNode){if(u.hasAttribute("data-prwidget-init")){return u}}return void (0)}function a(u){if(u&&u.nodeName&&s.test(u.className||"")){u.className=(u.className||"").replace(s,"")}}function f(u){if(u&&u.nodeName&&!s.test(u.className||"")){u.className=(u.className||"")+" handlerLoading"}}t.getWidgetElement=function(v,u){u=u||document.body;return u.querySelector(".prw_"+v)};t.call=function(u,v,z,C){if(typeof(u)!=="string"||!v||!z){throw"ta.prwidgets.call() requires method, event, element"}var y=k(z);var w=(v&&(v.type==="click"||v.type==="submit"));if(w){v.stopPropagation&&v.stopPropagation();v.preventDefault&&v.preventDefault();o=void (0)}if(!y){if(w){var x=g(z);if(x&&!x._prWidgetContext){o={};x._prPendingClick={key:o,args:Array.prototype.slice.call(arguments,0)}}}return false}var E=u.match(/^((?:[^\/]+\/)*[^\/\.]+)\.([^\/]*)?$/);var B=E[1];E=E[2].split(".");var D=Array.prototype.slice.call(arguments,1);var A=function(G){a(z);var F=void (0);while(E.length>0&&G){F=G;G=G[E.shift()]}if(typeof(G)!=="function"){throw"ta.prwidgets.call: '"+u+"' is not a function"}G.apply(F||{},D);return false};if(y[B]){return A(y[B])}else{f(z);y.widget.require(["trjs!"+B],A)}};q.exportTo(t,"ta.prwidgets");return t});define("ta/projects",["vanillajs","ns-exporter","ta/Core/TA.Store"],function(c,f,g){function b(i,h){return !!(i&&h&&!!i.className.match(new RegExp("\\b"+h+"\\b")))}var e={vals:{},set:function(h,i){e.vals[h]=i},setIfClass:function(j,i,h){if(typeof i=="string"){i=document.getElementById(i)}e.vals[j]=b(i,h)},get:function(h){return e.vals[h]},has:function(h){return h in e.vals}};function d(j,i,h){if(!e.has(j)){e.setIfClass(j,i,h)}return e.get(j)}var a={};a.isHotelsRedesign2011=function(){var h="isHotelsRedesign2011";if(!e.has(h)){if(window.pageServlet=="LastMinute"){e.set(h,true)}else{e.setIfClass(h,"HAC_SMRY","hotels_re_2011")}}return e.get(h)};a.isSmartDealsFilters=function(){return d("smartDealsFilters","DEALS","sdfilters")};a.isAttractionsRedesign2012=function(){return d("isAttractionsRedesign2012","ATTRACTIONS_2012","gridA")};a.isMetaHomepageIntegration2013=function(){return d("isMetaHomepageIntegration2013","PPT","ppt_container")};a.isMetaHotels2013=function(){return d("isMetaHotels2013","PAGE","meta_hotels")};a.isMetaHotelsRequest=function(){return g.has("isMetaHotelsRequest")};a.isSmartDealsHSXSortEnabled=function(){return g.has("isSmartDealsHSXSortEnabled")};a.isHacMap=function(){return g.has("hac.maps.isHacMap")};a.isHRTabs2014=function(){return g.has("hr_tabs_2014")};a.isTabletAlbumViewer=function(){return g.retrieve("tabletAlbumPhotoLightbox.enabled")};a.isAirport=function(){return window.pageServlet=="Airport"};f.exportTo(a,"ta");return a});define("ta/util/Pending",["vanillajs","ns-exporter","ta/Core/TA.Store","ta/Core/TA.Load"],function(vanilla,nsExporter,taStore,taLoad){var exports={};var _callbacks={};exports.waitForMore=function(id,fn,limit,args,bind){if(taStore.has("pending."+id)){exports.cancel(id)}taStore.store("pending."+id,{timer:fn.delay(limit,bind,args),fn:fn,t:"m",n:limit})};exports.waitForFn=function(id,fn){try{var tmp=eval(fn),data;if(tmp){if(typeOf(tmp)==="function"){if(id in _callbacks){_callbacks[id]()}else{if(taStore.has("pending."+id)){data=taStore.retrieve("pending."+id);if(data.evnt){tmp.attempt([data.evnt,data.elmt])}else{tmp.attempt()}}else{tmp.attempt()}}}else{if(IS_DEBUG){alert("fn is not a function: "+typeOf(tmp))}}}else{exports.waitForFnAgain(id,fn)}}catch(e){exports.waitForFnAgain(id,fn)}};exports.WAIT_DELAY=100;exports.WAIT_TIMEOUT=50;exports.waitForFnAgain=function(id,fn){var data=taStore.has("pending."+id)?taStore.retrieve("pending."+id):{t:"f",fn:fn,count:1};if(data.count<exports.WAIT_TIMEOUT){data.count++;data.timer=exports.waitForFn.invokeLater(exports.WAIT_DELAY,null,[id,fn]);taStore.store("pending."+id,data)}else{if(IS_DEBUG&&!taStore.has("pending.ignore."+id)){alert("timed out ("+(exports.WAIT_TIMEOUT*exports.WAIT_DELAY)+"ms) waiting for function: "+fn)}}};exports.waitForFile=function(id,file,fn){if(taLoad.load(file)){exports.waitForFn(id,fn)}};exports.waitForHandler=function(id,fn,evnt,elmt){taStore.store("pending."+id,{count:0,t:"f",fn:fn,evnt:evnt,elmt:elmt});exports.waitForFn(id,fn)};exports.cancel=function(id){var p=taStore.remove("pending."+id);if(p&&p.timer){clearTimeout(p.timer)}};exports.lock=function(id,fn,timer,fail){if(taStore.has("pending."+id)){return[fail,false].pick()}taStore.store("pending."+id,true);if(timer){exports.unlock.delay(timer,null,id)}return fn()};exports.unlock=function(id){var o=taStore.remove("pending."+id);if(o&&typeof o==="object"){o.count--;if(o.count===0){o.fn()}else{taStore.store("pending."+id,o)}}};exports.multilock=function(id,fn,count){taStore.store("pending."+id,{count:count,fn:fn})};exports.multilockUpdate=function(id,delta){var key="pending."+id,lock=taStore.retrieve(key);if(lock){lock.count+=delta}};exports.wait=function(id,fn,delay,bind,args){taStore.store("pending."+id,{timer:fn.delay(delay,bind,args)})};exports.waitForElement=function(id,elmtId,callback){if(taStore.has("pending."+id)){return}var elmt=document.getElementById(elmtId);if(elmt){exports.cancel("pending."+id);callback(elmt)}else{taStore.store("pending."+id,{timer:exports.waitForElement.delay(2,null,[id,elmtId,callback])})}};exports.waitFor=function(check,fn,delay){if(check()){return fn()}setTimeout(function(){exports.waitFor(check,fn,delay)},delay);return false};exports.waitWithPing=function(truth,callback,pingCb,pingDuration){function waiter(failureCount,interval,pingDuration){var t=truth();if(t){callback(t)}else{if(pingCb&&failureCount>0&&failureCount%Math.ceil(pingDuration*1000/interval)==0){pingCb(failureCount*interval/1000)}setTimeout(function(){waiter(failureCount+1,interval,pingDuration)},interval)}}waiter(0,100,pingDuration||3)};exports.waitForSelector=function(selector,callback,pingCb,pingDuration){exports.waitWithPing(function(){return document.querySelector(selector)},callback,pingCb,pingDuration)};nsExporter.exportTo(exports,"ta.util.pending");return exports});define("ta/util/I18N",["vanillajs","ns-exporter"],function(b,c){var a={};a.isRtl=function(){return !!document.body.className.match(/\brtl\b/)};c.exportTo(a,"ta.util.i18n");return a});define("utils/HistoryManager",["vanillajs","api-mod"],function(c,b){function a(){var f=0;var h={};var e={};this.pushState=function(i,k,j,m){var l=g();h[l]=m;i.id=l;history.pushState(i,k,j);f++};this.replaceState=function(i,k,j,m){var l=g();h[l]=m;i.id=l;history.replaceState(i,k,j)};this.addCallback=function(j,i){if(!e[j]){e[j]=[]}e[j].push(i)};this.removeCallback=function(k,j){if(e[k]){var i=e[k].indexOf(j);if(i>=0){e[k].splice(i,1)}}};this.doCallbacks=function(i){if(e[i]){e[i].each(function(j){j()})}};this.isSupported=function(){return(typeof history!="undefined")&&("pushState" in history)};this.getNumStatesAdded=function(){return f};function g(){return(new Date().getTime())+""+Math.random()}function d(l){var j=l.originalEvent.state;if(j&&j.id){var k=j.id;var i=h[k];i&&i(j.data)}f--}b.addEvent(window,"popstate",d)}return a});define("overlays/loading-spinner",["vanillajs"],function(){function b(d){return'<div style="padding:36px; min-width: 100px; min-height: 100px">'+d+"</div>"}function c(){var e='<div class="cssLoadingSpinner" style="display:block">'+a();for(var d=1;d<=8;d++){e+='<div class="cssLoadingSpinner_step'+d+'"></div>'}return e+"</div>"}function a(){var d=window.CDNHOST||(require.defined("ta/Core/TA.Store")&&require("ta/Core/TA.Store").retrieve("CDNHOST"));return'<div class="spinnerImage" style="position: absolute; top: 50%; left: 50%; width: 32px; height: 32px; margin-top: -16px; margin-left: -16px; background:url('+d+'/img2/generic/site/ajax-loader.gif)"></div>'}return function(d){var e=window.AnimationEvent?c():a();return d?e:b(e)}});define("overlays/utils",["vanillajs","overlays/loading-spinner","api-mod"],function(c,d,b){var a={};a.arrowDir={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"right",rightEvenInRtl:"left",bottomRight:"top",bottomLeft:"top"};a.arrowDirRtl={above:"bottom",below:"top",left:"right",right:"left",leftEvenInRtl:"left",rightEvenInRtl:"right",bottomRight:"top",bottomLeft:"top"};a.getArrowDir=function(k,i,e){var h=(b.hasClass(document.body,"rtl")?a.arrowDirRtl:a.arrowDir);if(k==="wideside"&&i&&e){var g=b.getSize(i);var f=b.getPosition(i);var j=b.getSize(e);return f.left>(j.x-f.left-g.x)?h.left:h.right}return h[k]};a.injectContent=function(f,g,i,e,h){if(b.isElement(i)){b.adopt(f,i)}else{if(e){i=b.find(e,g);b.removeClass(i,"hidden");b.adopt(f,i)}else{if(h){i=b.find(h);i&&(f.innerHTML+=i.innerHTML)}else{f.innerHTML+=i}}}};a.injectContentWithDataAttrs=function(f,g,i,e,h){i=i||(g&&g.getAttribute("data-content"))||"";e=e||(g&&g.getAttribute("data-element"))||"";h=h||(g&&g.getAttribute("data-element-copy"))||"";a.injectContent(f,g,i,e,h)};a.parseOffsets=function(e){if(!e||!e.length){return{x:0,y:0}}return{x:e[0]&&parseInt(e[0],10)||0,y:e[1]&&parseInt(e[1],10)||0}};a.loadingSpinnerHtml=d;return a});define("utils/array/flatten",["vanillajs"],function(){return function a(b){return b.reduce(function(d,c){return d.concat(Array.isArray(c)?a(c):c)},[])}});define("overlays/Overlay",["api-mod","mixins/Events","overlays/utils","utils/array/flatten"],function(d,c,b,e){var a=function(g,f){this.sourceElement=g;this.domParent=document.body;this.container=null;this.contentElement=null;d.mixin(this,new c("show","hide","destroy","positionDirty","hover","contentsUpdated"));d.bindAll(this,"show","hide","destroy");e(Array.prototype.slice.call(arguments,1)).filter(function(h){return typeof h==="function"}).forEach(function(h){h.call(this)}.bind(this))};a.prototype.isOpen=function(){return d.inDocument(this.container)};a.prototype.show=function(){if(d.inDocument(this.container)){return this}this.domParent.appendChild(this.container);this.container.overlay=this;this.emit("append");this.emit("show");return this};a.prototype.hide=function(f){if(!d.inDocument(this.container)){return this}delete this.container.overlay;this.domParent.removeChild(this.container);this.emit("hide",{trigger:f});return this};a.prototype.destroy=function(f){this.hide(f);this.emit("destroy",{trigger:f});this.sourceElement=null;this.contentElement=null;return this};a.prototype.reposition=function(){this.emit("positionDirty");return this};a.prototype.updateContent=function(f){this.contentElement.innerHTML="";b.injectContentWithDataAttrs(this.contentElement,this.sourceElement,f);this.emit("contentsUpdated");this.reposition();return this};return a});define("overlays/styles/modal",["vanillajs","api-mod"],function(d,b){function c(f,h,i,e,g){this.container=b.createElement(g||"span",{"class":"ui_overlay ui_modal "+h});if(i){this.header=b.createElement("div",{"class":"header_text"});this.header.innerHTML=i;this.container.appendChild(this.header)}if(e){this.subheader=b.createElement("div",{"class":"subheader_text"});this.subheader.innerHTML=e;this.container.appendChild(this.subheader)}this.inner=b.createElement("div",{"class":"body_text"});this.container.appendChild(this.inner);this.contentElement=this.inner;this.close=b.createElement("div",{"class":"ui_close_x"});this.container.appendChild(this.close)}var a=function(i,g,f,k,e,j,h){f=f||(i&&i.getAttribute("data-modal"))||"";k=k||(i&&i.getAttribute("data-header"))||"";e=e||(i&&i.getAttribute("data-subheader"))||"";return function(){c.call(this,g,f,k,e,h);this.updateContent(j);b.addEvent(this.close,"click",b.bind(function(){this.hide.apply(this,arguments)},this,"close-button"))}};return a});define("overlays/position",["vanillajs","api-mod","overlays/utils","ta/Core/TA.Event"],function(h,g,e,i){function c(o,n,m,l){return function(p,r,q){return function(){function s(){var y=g.getSize(this.arrow)||{x:0,y:0},z=a(p,this.sourceElement),u=(z?g.getSize(z):{x:0,y:0}),w=(z?g.getPosition(z):{left:0,top:0}),B=g.getSize(this.domParent),v=e.parseOffsets(k(p)),x=!z||r||f(this.sourceElement);this.container.style.position=x&&!q?"fixed":"absolute";var t=g.getSize(this.container);if(z&&z.getAttribute("data-anchorWidth")){if(g.hasClass(document.body,"rtl")){w.left+=u.x;u.x=Number(z.getAttribute("data-anchorWidth"));w.left-=u.x}else{u.x=Number(z.getAttribute("data-anchorWidth"))}}var A=(function(C,E,D,F){if(typeof C==="function"){var G=Math.floor(C(t,y,u,w,B,x))+E;if(this.domParent===document.body){G=Math.max(G,D);G=Math.min(G,F)}return G+"px"}else{return"auto"}}).bind(this);if(o&&n&&m&&l){this.container.style.position="fixed"}this.container.style.left=A(o,v.x,0,Math.max(B.x-t.x,0));this.container.style.right=A(m,v.x,0,Math.max(B.x-t.x,0));this.container.style.top=A(n,v.y,-Number.MAX_VALUE,Number.MAX_VALUE);this.container.style.bottom=A(l,v.y,-Number.MAX_VALUE,Number.MAX_VALUE)}this.on("show",s);this.on("positionDirty",s);this.reposition=s.bind(this)}}}function b(l,m){return function(){return function(){function n(){var o=g.getSize(this.container);this.container.style.position="fixed";if(l){if(g.hasClass(document.body,"rtl")){this.container.style.right="50%";this.container.style.marginRight=-o.x/2+"px"}else{this.container.style.left="50%";this.container.style.marginLeft=-o.x/2+"px"}}if(m){this.container.style.top="50%";this.container.style.marginTop=-o.y/2+"px"}}this.on("show",n);this.on("positionDirty",n)}}}function j(){return function(){return function(){function l(){g.addClass(this.container,"cssCentered")}this.on("show",l);this.on("positionDirty",l)}}}function a(m,l){if(!m||!m.length||!isNaN(m[0])){return l}return l&&g.find(m[0],l)}function k(l){if(!l||!l.length||!isNaN(l[0])){return l}return l.slice(1)}function f(l){while(l){if(l==document.body){return false}if(l.style.position){return l.style.position=="fixed"}if(l.currentStyle&&l.currentStyle.position==="fixed"){return true}if(window.getComputedStyle&&getComputedStyle(l).getPropertyValue("position")==="fixed"){return true}l=l.parentNode}return false}var d={};d.above=c(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?g.scrollLeft():0)},function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?g.scrollTop():0)});d.below=c(function(q,n,l,m,p,o){return m.left+(l.x/2)-(q.x/2)-(o?g.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?g.scrollTop():0)});d.bottomRight=c(function(q,n,l,m,p,o){return m.left-(o?g.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?g.scrollTop():0)});d.bottomLeft=c(null,function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?g.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?g.scrollLeft():0)});d.left=c(function(q,n,l,m,p,o){return m.left-q.x-n.x-(o?g.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?g.scrollTop():0)});d.right=c(function(q,n,l,m,p,o){return m.left+l.x+n.x-(o?g.scrollLeft():0)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?g.scrollTop():0)});d.on=c(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?g.scrollTop():0)});d.wideside=c(function(q,n,l,m,p,o){if(m.left>(p.x-m.left-l.x)){return m.left-q.x-n.x-(o?g.scrollLeft():0)}else{return m.left+l.x+n.x-(o?g.scrollLeft():0)}},function(q,n,l,m,p,o){return m.top+(l.y/2)-(q.y/2)-(o?g.scrollTop():0)});d.center=c(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return(p.y/2)-(q.y/2)+(o?0:g.scrollTop())});d.centerBelow=c(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return m.top+(l.y)+n.y-(o?g.scrollTop():0)});d.topCenter=c(function(p,n,l,m,o){return(o.x/2)-(p.x/2)},function(q,n,l,m,p,o){return 0});d.topLeft=c(null,function(q,n,l,m,p,o){return m.top-q.y-n.y-(o?g.scrollTop():0)},function(q,n,l,m,p,o){return p.x-(m.left+l.x)+(o?g.scrollLeft():0)});d.movingCenter=b(true,true);d.movingCenterX=b(true,false);d.movingCenterY=b(false,true);d.cssCentered=j();d.absolute=c(function(){return 0},function(){return 0});d.framed=c(function(){return 0},function(){return 0},function(){return 0},function(){return 0});d.offScreen=c(function(){return -10000},function(){return -10000});d.noop=function(){return function(){}};i.queueForReady(function(){d.rightEvenInRtl=d.right;d.leftEvenInRtl=d.left;if(typeof(document)!="undefined"&&g.hasClass(document.body,"rtl")){d.left=d.rightEvenInRtl;d.right=d.leftEvenInRtl;var l=d.bottomRight;d.bottomRight=d.bottomLeft;d.bottomLeft=l}},0,"initialize rtl position");return d});define("overlays/styles/windowshade",["vanillajs","api-mod"],function(c,b){var a=function(d){return function(){this.shade=b.createElement("div",{"class":"ui_backdrop "+(d||"dark")});this.on("show",function(){this.domParent.appendChild(this.shade)});var e=this.hide;this.hide=function(){if(b.inDocument(this.shade)){this.domParent.removeChild(this.shade)}e.apply(this,arguments)}}};return a});define("overlays/options/closeOnTaEvent",["vanillajs","ta/Core/TA.Event"],function(c,a){function b(){this.hide("on-event")}return function(d){return function(){var e=b.bind(this);this.on("show",function(){a.on(d,e)}).on("hide",function(){a.off(d,e)})}}});define("utils/object/set-props",["vanillajs"],function(){return function a(c,d){for(var b in d){if(d.hasOwnProperty(b)){c[b]=d[b]}}return c}});define("utils/object/shallow-copy",["utils/object/set-props","vanillajs"],function(b){return function a(e){var c;if(typeof(e)!=="object"||e===null){return e}if(e.constructor===Array){c=[];for(var d=0;d<e.length;++d){c.push(e[d])}}else{c=b({},e)}return c}});define("utils/AjaxData",["ta","mixins/Events","lib/jquery-amd"],function(c,b,e){function d(){}function a(u){u=u||{};var r=new b("update");var j=null;var h=null;var s=null;var g=null;var q=this;var m=0;var t=u.ajaxFunc||e.ajax;var f=u.transformer||d;var l=u.dataType||"html";var p=!!u.holdData;var i=void (0);this.dataVersion=0;function n(){return(s!==null||g!==null)}function k(){var v=n();var y=j;var w=g;j=null;s=null;g=null;if(w!==null){try{w.abort()}catch(x){}}if(y!==null){clearTimeout(y)}return v}function o(){var v=s;s=null;if(!v){return}var w;v.success=function(x){if(g==w){g=null;if(p){i=x}q.data=x;q.error=void (0);q.dataVersion=++m;f(q,w,v.data);r.emit("update")}};v.error=function(z,y,x){if(g==w){g=null;q.data=i;q.dataVersion=++m;q.error={type:y,error:x,status:z.status,responseText:z.responseText};f(q,w,v.data);r.emit("update")}};w=t(v);g=w;r.emit("update")}this.on=r.on.bind(r);this.off=r.off.bind(r);this.removeListener=r.removeListener.bind(r);this.isDone=function(){return !n()};this.isBusy=function(){return n()};this.clear=function(){var v=n()||typeof(this.data)!=="undefined"||typeof(this.error)!=="undefined";k();i=void (0);q.data=void (0);q.error=void (0);q.dataVersion=0;f(q);if(v){r.emit("update")}};this.refresh=function(z,v,y,w,x){k();if(!w||w<0){w=0}s={type:z,url:v,data:y,dataType:l,xhrFields:{withCredentials:true}};if(typeof x!=="undefined"){s.timeout=x}j=setTimeout(o,w);q.error=void (0);if(!p){q.data=void (0);f(q)}r.emit("update")};this.postJson=function(v,y,w,x){k();w=w||0;if(w<0){w=0}s={beforeSend:function(z){z.setRequestHeader("Content-Type","application/json")},type:"POST",url:v,contentType:"application/json",data:JSON.stringify(y),dataType:l,xhrFields:{withCredentials:true}};if(typeof x!=="undefined"){s.timeout=x}j=setTimeout(o,w);q.error=void (0);if(!p){q.data=void (0);f(q)}r.emit("update")}}return a});define("overlays/ajaxUtil",["vanillajs","ta","utils/object/shallow-copy","utils/AjaxData","mixins/Events","overlays/loading-spinner","utils/resourceLoader"],function(o,h,m,d,j,b,n){var c={};var q=10;var e=[];var k={};var g=q;var a=false;var s;var r=b();function i(y,u){var t=[];var x;for(x in u){if(u[x]){t.push(x)}}t.sort();var v=y;var z=v.indexOf("?")>=0?"&":"?";for(var w=0;w<t.length;++w){x=t[w];v+=z+encodeURIComponent(x)+"="+encodeURIComponent(String(u[x]));z="&"}return v}function p(){var t=0;var u={};var x=[];for(var w=e.length-1;w>=0;--w){var v=e[w];var y=k[v];if(y&&!u[v]){if(y.hasClients()||(++t<=q)){u[v]=y;x.push(v)}}}x.reverse();k=u;e=x;g=e.length+q;return e}function l(H,B){var J=this;var u=new d({dataType:"html",ajaxFunc:B.ajaxFunc});var C=new j("update","data-targetEvent");var t=B.loadingContent||r;var D=false;var L=!!B.sendTravelInfo;var A=void (0);var v=t;var G=u.dataVersion;var x=[];var K=0;var y;var E;function F(){var O=h.page.datesToQueryString("STAYDATES");if(O&&s!==O){s=O;p();for(var M=e.length-1;M>=0;--M){var N=k[e[M]];if(N.needsTravelInfo){N.invalidate()}}}}function I(S,O,Q,P,M,N){P=P&&h.page&&h.page.usingUnifiedDates;if(P){var R=h.page.datesToQueryString("STAYDATES");if(R){O+="&"+R}if(!a){a=true;s=R;h.page.on("dateSelected",F)}}if(M>1){if(M>20){return}O+="&reqNum="+M;if(!(N>=0)){N=2000}}else{N=0}if(!Q){S.refresh("GET",O,void (0),N)}else{S.refresh("POST",O,Q,N)}n.load(y,function(){E=true;w()})}function w(){if(u.isBusy()||!E){if(A){clearTimeout(A)}A=void (0);return}if(!u.data){if(u.dataVersion!==0){if(!J.error||J.error!==u.error){J.error=u.error||"no content";A=A||setTimeout(z,0)}}else{if(G!==0){v=t;G=u.dataVersion;x=[];if(C.hasListeners("update")){A=A||setTimeout(z,0)}}}return}if(G===u.dataVersion){return}try{var P=document.createElement("div");P.innerHTML=u.data;var N=D;var M=document.head||document.getElementsByTagName("head")[0];x=[];if(!B.noScript){Array.prototype.forEach.call(P.querySelectorAll("script"),function(Q){if(N){var R=document.createElement("script");R.setAttribute("type","text/javascript");if(Q.src){R.src=Q.src}if(Q.text){R.text=Q.text}R.setAttribute("data-rup",Q.getAttribute("data-rup"));M.appendChild(R);if(!Q.src){M.removeChild(R)}}Q.parentNode.removeChild(Q)})}Array.prototype.forEach.call(P.querySelectorAll("style"),function(Q){if(N){M.appendChild(Q)}else{Q.parentNode.removeChild(Q)}});Array.prototype.forEach.call(P.querySelectorAll("[data-targetEvent]"),function(Q){x.push(Q);Q.parentNode.removeChild(Q)});if(N){D=false;c[B.inlineResourceId]=true}v=P.innerHTML;G=u.dataVersion;u.data=void (0)}catch(O){J.error="invalid HTML"}A=A||setTimeout(z,0)}function z(){var M=!C.hasListeners("update");var R;A=void (0);J.data=v;J.dataVersion=G;C.emit("update");while((R=x.shift())){var Q=R.getAttribute("data-targetEvent");if(Q==="repoll-required"){if(M){x=[];J.data=v=t;J.dataVersion=G=0;return}if(!(++K>1)){K=2}var N=Number(R.getAttribute("data-delay"));I(u,H,B.reqParams,L,K,N)}else{if(Q==="offerClickTrackingTree"){try{var O=require("commerce/impression-tracker");if(O){O.onTrackingTreeElement(R)}}catch(P){}}else{C.emit("data-targetEvent",Q,R)}}}}this.error=void (0);this.loadingData=t;this.data=v;this.dataVersion=G;this.needsTravelInfo=L;this.on=C.on.bind(C);this.off=C.off.bind(C);this.removeListener=C.removeListener.bind(C);this.init=function(){u.on("update",w.bind(this))};this.isBusy=function(){return u.isBusy()||A};this.isDone=function(){return !u.isBusy()&&!A};this.invalidate=function(){u.clear();K=0;if(this.hasClients()){I(u,H,B.reqParams,L,0,0)}};this.hasClients=function(){return(C.hasListeners("update"))};this.load=function(){if(u.isBusy()){return}else{if(u.dataVersion!==0){setTimeout(function(){C.emit("update")},1);return}}var T=B.reqParams;var R=!B.isWidget||!B.inlineResourceId||!c[B.inlineResourceId];if(R){var Q=[];var S=[];var N=document.head||document.getElementsByTagName("head")[0];var P;var O=document.head.querySelectorAll('link[type="text/css"][rel=stylesheet][data-rup]');for(var M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){Q.push(P)}}O=document.querySelectorAll("script[data-rup]");for(M=0;M<O.length;M++){P=O[M].getAttribute("data-rup");if(P){S.push(P)}}D=true;T=(T?m(T):{});T.haveJses=String(S);T.haveCsses=String(Q);if(B.isWidget){T.Action="install"}}y=B.resources;K=0;I(u,H,T,L,0,0)}}function f(v,u){var w=i(v,u.reqParams);if(w.length<128){v=w;u.reqParams=void (0)}var t=k[w];if(!t){t=new l(v,u);t.init();if(!u.noCache){k[w]=t}}if(!u.noCache){e.push(w);if(e.length>g){p()}}return t}return{loadData:function(u,t){!t&&(t={});var v=f(u,t);v.load();return v},loadOverlayWidget:function(w,u){var t="/OverlayWidgetAjax?Mode="+w;if(typeof(crPageServlet)==="string"){t+="&metaReferer="+encodeURIComponent(crPageServlet)}u=(u?m(u):{});u.inlineResourceId=w;u.isWidget=true;var v=f(t,u);v.load();return v},cleanCache:p}});define("overlays/options/ajax",["vanillajs","overlays/ajaxUtil"],function(d,b){function a(e){return e&&e.match(/^((https?:)?(\/\/)?([\da-z\.\-\u00a1-\uffff]+)\.([a-z\.\u00a1-\uffff]{2,6}))?(\/[\w]+)*(\?[\/\w\.+%=\-#&\/!\u00a1-\uffff]+)?$/)}function c(f,e){if(!e){e={}}function g(){if(this.sourceElement){f=f||this.sourceElement.getAttribute("data-url");if(e.noCache===undefined){e.noCache=this.sourceElement.getAttribute("data-ajaxNoCache")}if(!e.resources){e.resources=this.sourceElement.getAttribute("data-resources");if(e.resources){e.resources=e.resources.replace(/[\[\]]/g,"").split(/[ ,]+/)}}}if(!f){return}var j;var m=0;var l=(function(){if(j.dataVersion!==m){this.contentElement.innerHTML=j.data;this.emit("contentsUpdated");m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}}this.reposition();setTimeout(this.reposition.bind(this),1);this.emit("contentLoaded",j.error)}).bind(this);var k;var i=(function(){if(k==f){this.reposition();return}j&&j.invalidate();k=f;j=b.loadData(f,e);this.contentElement.innerHTML=j.data;this.emit("contentsUpdated");this.reposition();m=j.dataVersion;if(require.defined("ta/prwidgets")){require("ta/prwidgets").initWidgets(this.contentElement)}j.on("update",l);j.on("data-targetEvent",h)}).bind(this);var h=this.emit.bind(this,"data-targetEvent");this.on("show",i);this.on("hide",function(){if(j){j.off("update",l);j.off("data-targetEvent",h);j=void (0)}});var n=this.updateContent;this.updateContent=function(o){if(!o){f="";o=this.sourceElement.getAttribute("data-url");return o?this.updateContent(o):n.apply(this,arguments)}if(!a(o)){f="";return n.apply(this,arguments)}f=o;if(this.isOpen()){i()}return this}}return g}return c});define("ta/media/viewerScaffold",["api-mod","vanillajs","utils/HistoryManager","ta/photos/oysterTracking","overlays/Overlay","overlays/styles/modal","overlays/position","overlays/styles/windowshade","overlays/options/closeOnTaEvent","overlays/options/ajax"],function(t,u,r,b,m,c,H,C,d,x){var h;var l;var j;var e;var g=false;var n;var v=ta.isTabletAlbumViewer();var D=v?0:20;var F;var a=new A();var s="#photos";var p=s+";";function A(){var I=[];this.register=function(M,L,N,K){if(!N){K=true;N=ta}var O=K?"on":"addEvent";var J=K?"off":"removeEvent";N[O](M,L);I.push(function(){N[J](M,L)})};this.addCleanup=function(J){I.push(J)};this.cleanup=function(){I.forEach(function(J){J()});I=[]}}function E(){if(l&&l.onResize){l.onResize()}}function y(){a.register("resize",E,window);E();if(l&&l.onLoad){l.onLoad()}var I=ta.retrieve("oyster_location_data");if(I&&I.hasOyster&&I.hasOyster[j]){b.trackCandidateSession(null,null,null,"LB_OPEN")}a.register("mediaViewerEscapePressed",function(){try{h.fireEvent("onClose",h)}catch(J){}h.hide()})}function k(){document.body.addClass("remove-scrolling");if(ta.retrieve("checkrates.meta_ui_post_click_prices")&&ta.retrieve("meta.baseLocationId")&&ta.meta.update){ta.commerce.meta.updateProvAreaFromLightBox(ta.retrieve("meta.baseLocationId"))}if(l&&l.onShow){l.onShow()}if(v){if(ta.retrieve("tabletRacOnPhotoViewer")){ta.remove("RASCalendar");if(ta.restaurantAvailabilitySearch){F=ta.restaurantAvailabilitySearch.getContainerSelector()}}ta.find(".albumLightbox .ui_close_x").addClass("svgico")}ta.fireEvent("refreshedDOMContent",h.container)}function z(){h.container.removeClass("loaded");ta.fireEvent("mediaViewerLightboxHide");document.body.removeClass("remove-scrolling");if(l&&l.onClose){l.onClose()}ta.remove("meta.requestFromArea");var I=ta.retrieve("metaCheckRatesOverlay");if(I){I.hide();ta.remove("metaCheckRatesOverlay")}if(ta.meta.linkTracking){ta.meta.linkTracking.restoreCRPageServlet()}if(ta.retrieve("photo.viewer.refreshOnClose")){window.location=window.location}if(ta.has("translationOverlay")){ta.retrieve("translationOverlay").hide()}if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")&&ta.isMetaHotelsRequest&&ta.isMetaHotelsRequest()){ta.commerce.minimeta.doMetaDateSearch();ta.remove("hotels.datesChanged")}else{if(ta.retrieve("hotels.redesignEnabled")&&ta.retrieve("hotels.datesChanged")){ta.commerce.minimeta.ajax.resetAjaxCall();ta.commerce.minimeta.ajax.send(false,true);ta.remove("hotels.datesChanged")}}ta.widgets.calendar.closeCalendarWidgets();a.cleanup();if(v){if(ta.retrieve("tabletRacOnPhotoViewer")){ta.remove("RASCalendar");if(ta.restaurantAvailabilitySearch){ta.restaurantAvailabilitySearch.setContainerSelector(F)}}}if(l&&l.onHide){l.onHide()}ta.fireEvent("photoLightBoxHidden")}function w(I){ta.store("media.albums.loadOnEvent",true);a.register("show",k,h,true);a.register("hide",z,h,true);y();k();if(ta.has("albumViewer.historyEnabled")){f(I)}setTimeout(function(){ta.fireEvent("mediaViewerDOMLoaded");ta.prwidgets&&ta.prwidgets.initWidgets(h.container)},1)}function q(N){var J=N;J.heroMinWidth=window.getSize().x-D*2;J.heroMinHeight=window.getSize().y-D*2;if(!N.albumViewMode){if(N.ff||N.imageId){J.ff=N.ff||N.imageId;J.albumid=101;J.albumViewMode="hero";J.albumPartialsToUpdate="full";J.thumbnailMinWidth=50;J.cnt=30;J.offset=-5;J.baseMediaId=J.ff;J.extraAlbumCoverCount=2}if(N.albumId){J.albumid=N.albumId;J.albumViewMode="images";J.albumPartialsToUpdate="full";J.extraAlbumCoverCount=4}}var I="QC_Meta_Mini|Photo_Lightbox";J.area=I;ta.commerce.meta.tracking.resetTimingLockForNavArea(I);if(window.pageServlet){Object.merge(J,{metaReferer:window.pageServlet})}var K="/LocationPhotoAlbum?"+Object.toQueryString(J);var L=K;try{K=ta.commerce.meta.tracking.updateUrlWithTiming(K,I)}catch(M){ta.util.error.record(M,"problem updating url with timing in viewerScaffold");K=L}return K}function B(J,L){var K=window.location.hash;if(K.indexOf(s)>=0){var I=i();if(I){if(!I.detail&&window.modelLocId){I.detail=window.modelLocId}if(!I.geo&&window.modelGeoId){I.geo=window.modelGeoId}G(I,true)}else{G({detail:J,geo:L},true)}}}function i(){var I=window.location.hash;var J=I.indexOf(p)>=0&&I.substring(I.indexOf(p)+p.length,I.length);if(J&&J.length>0){return J.parseQueryString(false,false)}return null}function f(J){var I=new r();if(I.isSupported()){if(J){var K=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search;window.history.replaceState(null,null,K)}a.register("albumViewerPushState",I.pushState);a.register("albumViewerReplaceState",I.replaceState);a.register("mediaViewerLightboxHide",function(){window.history.go(-1*(I.getNumStatesAdded()))});t.addEvent(window,"popstate",function(){if(window.location.hash.indexOf(s)>=0){h.show()}else{h.hide()}})}}function G(O,J){if(!O.geo||!O.detail){ta.util.error.record(null,"viewerScaffold.js:load missing required arguments");return false}l=O.evtDelegates;O.evtDelegates=null;j=O.detail;e=O.geo;var N="dark mediaAlbumsBackdrop";var L="albumLightbox";var I=H.framed([0,0]);var M=[ta.isTabletAlbumViewer()&&window.getCssAlbumPhotoLBIconAsset&&window.getCssAlbumPhotoLBIconAsset(),window.cssAlbumViewerAssetHotels,window.cssPhotoLightboxAsset,window.cssAlbumViewerExtendedAsset,window.hrExtraCssLightboxAsset,window.jsAlbumViewerExtendedAsset,window.g_jqueryFiles];if(!h){var K=0;var P=setInterval(function(){ta.trackEventOnPage("Photo_LB","slow_load",(++K)*30,navigator.userAgent)},30000);h=new m(document.body,c(null,"",L),I,C(N),d("ibOfferClick"),x(q(O),{resources:M,noCache:true}));h.on("contentLoaded",function(){clearInterval(P);w(J)}).on("hide",clearInterval.bind(null,P));h.on("data-targetEvent",ta.fireEvent.bind(ta))}else{h.updateContent(q(O))}if(!g){n=Date.now();g=true}h.show()}function o(){if(n){return Date.now()-n}return null}return{getTimeSincePhotoviewerFirstOpened:o,load:G,handleFragment:B,parseFragment:i}});define("utils/flash",["ta/util/Error","vanillajs"],function(b,e){var a=null,c=function(){if(!a||!a.loaded){try{a=d();a.loaded=true}catch(f){b.record(f,"getFlashPlayerVersion: Error trying to fetch flash version")}}if(a){return a.major+"."+a.minor+"."+a.rev}else{return"0.0.0"}},d=function(){var h=[0,0,0];if(navigator.plugins&&navigator.mimeTypes.length){var f=navigator.plugins["Shockwave Flash"];if(f&&f.description){h=f.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".")}}else{var i=null;if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){i=1;var g=3;while(i){try{g++;i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+g);h=[g,0,0]}catch(k){i=null}}}else{try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(k){try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");h=[6,0,21];i.AllowScriptAccess="always"}catch(k){if(h[0]!==null&&h[0]==6){return h}}try{i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(k){}}if(i!==null){try{h=i.GetVariable("$version").split(" ")[1].split(",")}catch(k){}}}}var j={major:(h[0]!==null?h[0]:0),minor:(h[1]!==null?h[1]:0),rev:(h[2]!==null?h[2]:0)};return j};return{getVersion:c,detectVersion:d}});define("ta/media/player/TA_JWPlayer",["ta","lib/jquery-amd","utils/ajax","ta/Core/TA.Event","ta/util/Error","ta/Core/TA.Store","utils/flash","utils/resourceLoader","ns-exporter"],function(h,C,D,f,G,k,I,m,o){var v=false;var x=false;var w=false;var j=null;var F="googima";var s={major:10,minor:0,rev:0};var p=null;var K=!!(h.m&&h.m.store);var Q=function(S){return K?h.m.store.has(S):h.has(S)},d=function(S){return K?h.m.store.get(S):k.retrieve(S)},z=function(T,S){return K?h.m.store.add(T,S):k.store(T,S)},N=function(T){var S=window.CDNHOST||"";return S+T};var J=N("/js3/lib/");var l=N("/js3/");var g="jwplayer_v7-c.js";var E="jwplayer7/jwplayer.flash.swf";var B="jwplayer7/provider.html5.js";var O="jwplayer7/skins/glow.css";var H="nh2hat+tarRNMkESWRU2sRWyEtmC00+lgZPnMg==";var b=3;var A=0;var e=0;var y=false;var a=0;var t=function(T){var S={timeout:30000,playerHeight:391,playerWidth:521,containerId:null,videoUrl:null,previewUrl:null,mediaId:0,locationId:0,autostart:false,aspectratio:null,closedCaptions:null,stretching:"bestfit",mute:false,initFailureCallback:null,setupErrorCallback:null,readyCallback:null,isLocationPhotoAlbum:false,disableAds:false,sponsoredVideo:false,adMessageText:null,disableSkipAd:false,adSkipText:null,adSkipTimerText:null,adSkipCallback:null};if(T.width&&T.aspectratio){delete S.playerHeight;delete S.playerWidth}var V={usable:true,ready:false};var U=false;var W=false;R("JWPlayer.initialize");if(T){S=C.extend(S,T||{});R("JWPlayer.initialize: options:",T)}u();this.getPlayer=function(){if(window.jwplayer&&S.containerId){return jwplayer(S.containerId)}return null};this.stop=function(){if(!x||!V.usable||!V.ready||S.containerId||typeof jwplayer=="undefined"){return}try{this.getPlayer().stop()}catch(X){}};this.getState=function(){if(!x){return"UNINITIALIZED"}else{if(!V.ready){return"UNLOADED"}else{if(this.getPlayer()){try{return this.getPlayer().getState()}catch(X){n(X,"getState exception");return"ERROR"}}}}};this.unload=function(){try{if(this.getPlayer()&&typeof this.getPlayer().getState==="function"){this.getPlayer().stop();this.getPlayer().remove()}}catch(X){n(X,"error unloading the video player")}};this._loadAPI=function(){R("_loadAPI: Loading jwplayer API");if((typeof jwplayer=="undefined"||!jwplayer)&&!w){R("_loadAPI: flash plug-in detection: v"+I.getVersion());w=true;var aa=l+g;try{R("_loadAPI: loading jwplayer asset: ",aa);var X=function(){if(typeof jwplayer=="undefined"){this._checkAPILoadFailure(false)}else{jwplayer.key=H;x=true;w=false;R("_loadAPI:"+aa+" loaded")}};m.load([aa],X)}catch(Z){n(Z,"_loadAPI: init failure",null,{url:aa})}var Y=this;window.setTimeout(function(){Y._checkAPILoadFailure(false)},S.timeout)}else{R("_loadAPI: api already loaded");x=true}};this._checkAPILoadFailure=function(X){try{if(typeof X=="undefined"){X=true}if(!V.usable){return}w=false;if(j){window.clearTimeout(j)}if(!x){if(window.jwplayer){x=true;jwplayer.key=H;n(null,"_checkAPILoadFailure found hasAPILoadedOnPage to be false, but API is loaded; Asset.javascript onLoad failed.")}else{V.usable=false;var Y="jwplayer javascript api failed to load ";Y+=(X?"in "+S.timeout+" ms.":"immediately; bad url possible.");n(null,Y,null,{url:J+g});if(typeof S.initFailureCallback=="function"){try{S.initFailureCallback()}catch(Z){n(Z,"error while executing onInitFailure")}}else{R("onInitFailure not set")}}}else{R("_checkAPILoadFailure verified API is loaded.")}}catch(Z){n(Z,"_checkAPILoadFailure exception")}};this.clearVideo=function(){var Y=C("#"+S.containerId);Y.empty();if(Y.attr("tag")=="object"){var X=C("#"+S.containerId+"_wrapper");if(X.length){X.empty().prop("id",S.containerId);return X.get(0)}}return Y.get(0)};this._getVideoSources=function(){var X=i();var Z=[];if(S.videoFormats){S.videoFormats.forEach(function(aa){if((aa==".flv"&&X)||aa==".mp4"||aa==".webm"){Z.push({file:S.videoUrl+aa})}})}else{if(S.videoUrl){var Y=/\.flv$/.test(S.videoUrl);if(!Y||X){Z.push({file:S.videoUrl})}}}R("getSources: Video sources are:");if(v){Z.forEach(function(aa){R(aa.file)})}return Z};this._isAutoStart=function(){var Y=Q("jwplayerHelper.preroll.autostartOnce")&&d("jwplayerHelper.preroll.autostartOnce");var X=S.autostart||Y;if(Y){z("jwplayerHelper.preroll.autostartOnce",false);R("Forcing autostart for this pageview")}return X};this.setup=function(Y){try{if(Y){R("setup: recurse");Y+=1}else{R("setup");Y=1;this.stop()}if(!V.usable){return}var Z=document.getElementById(S.containerId);if(!Z){n(null,"JWPlayer.setup: Container element does nt exist on page");return}if(!x){if(!w){this._loadAPI()}if(!x){if((Y*200)<S.timeout){R("setup waiting for api to load...");var X=this;j=window.setTimeout(function(){X.setup(Y)},200)}else{n(null,"setup: setTimeout max limit reached")}return}}if(typeof jwplayer=="undefined"){n(null,"setup: jwplayer is undefined.");return}this._setupPlayerOptions()}catch(aa){n(aa,"setup exception")}};this._setupPlayerOptions=function(){try{var X=this._getJwPlayerOptions();if(!X){return}this.getPlayer().setup(X);this._addSetupCallbacks();this._addAdCallbacks();this._addPlayCallbacks();V.ready=true;if(isNaN(S.mediaId)){S.mediaId=0}if(isNaN(S.locationId)){S.locationId=0}}catch(Y){n(Y,"_setupPlayerOptions exception")}};this._getJwPlayerOptions=function(){var X=this._getVideoSources();if(X.length===0){this._showDefaultVideoPreviewImage();return null}var Y={width:S.playerWidth,height:S.playerHeight,flashplayer:J+E,html5player:J+B,skin:{name:"glow",url:J+O},sources:X,image:S.previewUrl,autostart:this._isAutoStart(),stretching:S.stretching,mute:S.mute};if(S.aspectratio){Y.width="100%";delete Y.height;Y.aspectratio=S.aspectratio}if(S.closedCaptions){Y.captions=S.closedCaptions}if(this._shouldAdsBeShown()){var aa=this._getAdDetails();var Z=this._getCompanionAdDetails();if(aa){if(Z){aa.companiondiv=Z}Y.advertising=aa;Y.primary="html5"}}return Y};this._stringifyTargeting=function(Y){var Z="";for(var X in Y){if(Z.length){Z+="&"}if(C.inArray(typeof Y[X],["string","number","boolean"])>-1||C.isArray(Y[X])){Z+=X+"="+Y[X].toString()}}return encodeURIComponent(Z)};this._getAdDetails=function(){var ac=S.adMessageText||d("jwplayerHelper.localize.videoWillResume")||"Your video will resume in xx seconds";var ag=S.adSkipText||d("jwplayerHelper.localize.skipVideoAd")||"Skip";var ad=S.adSkipTimerText||d("jwplayerHelper.localize.skipAdTimerText")||"Skip in xx";var aa=(S.sponsoredVideo)?d("jwplayerHelper.sponsoredVideoAdUrl"):d("jwplayerHelper.adUrl");if(aa&&aa!==""){var Y=d("ads.locationphotoslightbox.pageTargeting")||d("ads.pageTargeting");if(S.isLocationPhotoAlbum){Y=d("ads.locationphotoalbum.pageTargeting")}try{var X=parseInt(Math.random()*100000,10);aa+="&correlator="+X;if(Y){var ae=this._stringifyTargeting(Y);if(ae){aa+="&cust_params="+ae}}var ab=this._getVideoAuthorString();if(ab&&ab.length){aa+=";author="+ab}aa+=";random="+Math.floor(Math.random()*10000)}catch(Z){G.record(Z,"Error building video preroll url")}R("_getAdDetails: showing pre-roll: ",aa);var af={client:F,tag:aa,admessage:ac};if(!S.disableSkipAd){af.skiptext=ag;af.skipoffset=b;af.skipmessage=ad}return af}else{R("_getAdDetails: no pre-roll ad")}};this._getVideoAuthorString=function(){var X="user";var Y=d("jwplayerHelper.video.author.icaption");if(Y){Y=Y.toLowerCase();if(Y.indexOf("association")>=0){X="owner"}else{if(Y.indexOf("professional")>=0){X="professional"}}}return X};this._showDefaultVideoPreviewImage=function(){var X=document.getElementById(S.containerId);if(X){X=this.clearVideo()}if(X&&S.previewUrl){C("<img>").attr({width:S.playerWidth,height:S.playerHeight,src:S.previewUrl,id:"photo_error","class":"pageLink",style:"display:block; margin:auto; visibility:visible; "}).appendTo(X);if(Q("photo.viewer.localization.videoError")){C("<div>"+d("photo.viewer.localization.videoError")+"</div>").attr({"class":"videoError",style:"display:block; z-index:2; "}).appendTo(X)}R("setup: no supported video playback, using preview image instead")}};this._getCompanionAdDetails=function(){var X={width:300,height:250};var Y;if(S.isLocationPhotoAlbum){Y=C("#gpt-ad-300x250-locationphotoalbum")}else{if(window.pageServlet&&window.pageServlet==="LocationPhotos"){Y=C("#LOC_PHOTOS .gpt-ad-300x250-300x600")}}if(Y.length){X.id=Y.attr("id");return X}return null};this._addSetupCallbacks=function(){if(S.readyCallback&&typeof S.readyCallback=="function"){this.getPlayer().on("ready",S.readyCallback)}if(S.setupErrorCallback&&typeof S.setupErrorCallback=="function"){this.getPlayer().on("setupError",S.setupErrorCallback)}};this._addPlayCallbacks=function(){var X=this;if(X.getPlayer()){X.getPlayer().on("buffer",function(){X._logVideoEvents("buffering")});X.getPlayer().on("play",function(){X._logVideoEvents("play");C(window).trigger("videoPlayer_play");if(!W){c();W=true}});X.getPlayer().on("pause",function(){X._logVideoEvents("pause");C(window).trigger("videoPlayer_pause")});X.getPlayer().on("seek",function(){X._logVideoEvents("seek")});X.getPlayer().on("complete",function(){X._logVideoEvents("complete");C(window).trigger("videoPlayer_complete");W=false});X.getPlayer().on("error",function(Y){X._logVideoEvents("error");n(null,"jwplayer().onError "+Y.message,null,Y);X._showDefaultVideoPreviewImage()});if(S.sponsoredVideo){X.getPlayer().on("adCompanions",function(Y){C(window).trigger("videoPlayer_preroll_companions_found",Y)})}X.getPlayer().on("fullscreen",function(Y){if(Y.fullscreen){X._logVideoEvents("full screen");C(window).trigger("videoPlayer_enter_fullscreen")}else{X._logVideoEvents("normal screen");C(window).trigger("videoPlayer_exit_fullscreen")}});X.getPlayer().on("mute",function(){var Y=X.getPlayer().getMute();if(Y){C(window).trigger("videoPlayer_audio_off")}else{C(window).trigger("videoPlayer_audio_on")}})}};this._logVideoEvents=function(Y){if(!this.getPlayer()){return}try{var aa={a:Y,b:S.mediaId,loc:S.locationId,t:this.getPlayer().getPosition(),a_buffer:this.getPlayer().getBuffer(),a_duration:this.getPlayer().getDuration(),flashver:"JWPlayer7.8.1"};var X=this;D({url:"/LogMediaClick",data:aa,success:function(){R("logLookbackEvent: /LogMediaClick?a="+Y+"&b="+S.mediaId+"&loc="+S.locationId+"&t="+X.getPlayer().getPosition()+"&a_buffer="+X.getPlayer().getBuffer()+"&a_duration="+X.getPlayer().getDuration()+"&flashver=JWPlayer7.8.1")},error:function(){n(null,"logLookbackEvent failed.")}})}catch(Z){n(Z,"logLookbackEvent exception")}};this._addAdCallbacks=function(){this.getPlayer().on("adComplete",this._onPrerollAdFinished.bind(this));if(S.adSkipCallback&&typeof S.adSkipCallback==="function"){this.getPlayer().on("adSkipped",S.adSkipCallback)}else{this.getPlayer().on("adSkipped",this._onPrerollAdFinished.bind(this))}this.getPlayer().on("adPlay",this._onPrerollAdPlay.bind(this))};this._onPrerollAdPlay=function(){C(window).trigger("videoPlayer_preroll_start");var Y=this._getCompanionAdDetails();if(Y){var X=C("#"+Y.id);X.removeClass("taEmpty");X.show();if(!U){q();U=true}}};this._onPrerollAdFinished=function(){C(window).trigger("videoPlayer_preroll_end");var aa=this._getCompanionAdDetails();if(aa){var Z=document.getElementById(aa.id);if(!K&&Z){var Y=[];Y.push(Z.id);var X={isNewContext:true,elemIds:Y};f.fireEvent("ads.queueForInjection",X)}}U=false};this._requiresVideoCounts=function(){if(S.disableAds){R("_requiresVideoCounts: ads disabled in the options");return false}else{if(/test\.s/.test(d("ads.gptBase"))){R("_requiresVideoCounts: always show ads for advert");return false}else{if(d("jwplayerHelper.preroll.forceOnce")===true){z("jwplayerHelper.preroll.forceOnce",false);R("_requiresVideoCounts: forcing preroll once");return false}}}return true};this._shouldAdsBeShown=function(){if(S.disableAds){R("_shouldAdsBeShown: ads disabled in the options");return false}else{if(S.sponsoredVideo){return true}else{if(/test\.s/.test(d("ads.gptBase"))){R("_shouldAdsBeShown: always show ads for advert");return true}else{if(d("jwplayerHelper.preroll.forceOnce")===true){z("jwplayerHelper.preroll.forceOnce",false);R("_shouldAdsBeShown: forcing preroll once");return true}else{if(y){if(e<3&&A%3===0){R("_shouldAdsBeShown: video count is okay to show ad");return true}R("_shouldAdsBeShown: video count does not permit to show ad")}else{R("_shouldAdsBeShown: video counts are not loaded. So cannot show ad")}}}}}return false}};var R=function(T,S){if(v&&console&&console.log){if(T){console.log("JWPlayer - "+T)}if(S){console.log(S)}}},n=function(S,V,W,U){G.record(S,"JWPlayer - "+V,W,U);var T=(S?S.toString()+" ":"");R(T+V)},i=function(){try{if(!p||!p.loaded){p=I.detectVersion();p.loaded=true}return(p&&s&&p.major>=s.major&&p.minor>=s.minor&&p.rev>=s.rev)}catch(S){G.record(S,"hasFlashPlayerRequired");return false}},u=function(){R("_getVideoCountsFromSession: Trying to get counts from session");var S="https://www.tripadvisor.com/VideoSessionAjax?random="+Math.floor(Math.random()*10000)},r=function(S,U){if(!S){S=A}if(!U){U=e}R("_setVideoCountsInSession: Trying to set video counts in session: Video: "+S+" Ad: "+U);var T="https://www.tripadvisor.com/VideoSessionAjax?vpc="+S+"&vapc="+U+"&random="+Math.floor(Math.random()*10000)},q=function(){R("_incrementAdPlayCount: incrementing ad playcount currently: "+e+" by 1");e+=1;P()},c=function(){R("_incrementVideoPlayCount: incrementing video playcount currently:"+A+" by 1");A+=1;P()},M=function(){return a>0},P=function(){if(y){R("_sendVideoCounts: video counts have loaded. Trying to set the count in session");r(A,e)}else{if(!M()){R("_sendVideoCounts: video counts have not loaded or in progress. Trying to set the get count from session");u()}}};var L={createPlayer:function(S){var T=new t(S);T.setup();return T},hasRequiredFlashPlayer:i,enableDebug:function(){v=true},disableDebug:function(){v=false}};o.exportTo(L,"ta.media.JWPlayer");return L});require(["ta/p13n/placements"],function(t){var a=t.define.bind(t,"photoviewer","handlers",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);a(["placement","lib/jquery-amd","ta/prwidgets","ta/Core/TA.Event","ta/util/Error","ta/Core/TA.Store","ta/projects","utils/ajax","ta/util/Pending","ta/util/I18N","utils/resourceLoader","ta/media/viewerScaffold","sidebar","ta/media/player/TA_JWPlayer","switchingTabs","thumbsScroller","tracking","tablet","preloader","autoplayOverlay"],function(t,a,r,o,i,n,l,d,s,u,h,c,m,p,f,g,v,b,w,P){function y(){return a(".photoRegion",U).attr("data-view")}function I(e){var t=39==e.which,r=37==e.which,i=27==e.which;if(t||r){var n=a(t?".heroNav.right":".heroNav.left",U);if(n.length&&!n.hasClass("disabled")){var l=me?r:t;K.advanceHero(n,l)}}else i&&o.fireEvent("mediaViewerEscapePressed")}function T(){ue.init(U,".lbTabs li",function(e){K.loadData(e.attr("data-href"))})}function C(){var e=a(".photoGrid",U);e.on("scroll",function(){var t=a(".moreImageThumbs",e);t.length&&a(".photoGridBox",e).height()<e.scrollTop()+e.height()&&K.loadData(t.attr("data-href"))}),m.initScrollHandlers(K.loadData)}function V(){window.AnimationEvent&&(z=setTimeout(function(){a(".cssLoadingSpinner",U).show()},1e3))}function S(){clearTimeout(z),a(".cssLoadingSpinner",U).hide()}function k(e,t){var a="#photos;"+Object.toQueryString(e),r=function(e){K.loadData(e,null,null,!0)};o.fireEvent(t,{data:e},document.title,a,r)}function A(e){"hero"!=e&&"heroThumbs"!=e?o.fireEvent("nonHeroPhotoLoaded"):"hero"==e&&0===ce&&o.fireEvent("heroPhotoLoadedFromAlbum")}function L(e,t){W(e);var r=a(".heroPhoto",U),o=r.attr("data-panorama");o&&fe(o),H(r),K.tracking.recordImpressionIfDmo(),ne=t,l.isTabletAlbumViewer()&&!j()&&K.tablet.addSwipingEventHandlers()}function H(e){var t=parseInt(e.attr("data-albumid"),10),a=parseInt(e.attr("data-media-filter"),10),r=parseInt(e.attr("data-media-type"),10),o=e.attr("data-mediaid"),i=e.attr("data-panorama");if(i){var n=D(o);K.tracking.recordPanoHeroView(n,t,a)}else{var l=parseInt(o,10);K.tracking.recordHeroView(l,t,a,r)}}function E(e,t,r){V();var o=t&&t.length>0,i=a(".mainImg .videoPlayer",U);i.length&&(he&&he.unload(),i.remove()),a(".mainImg img",U).length||a("<img>").appendTo(a(".mainImg",U)),a(".heroWrapper",U).removeClass("panorama"),window.removepano&&removepano("albumViewerPano"),ne=e;var n=a(".heroPhoto",U);n.attr("data-mediaid",e),K.refreshDisplay(!1,!0,!1);var d=a(".tinyThumb.current",U),s=d.attr("data-bigurl"),u=d.attr("data-dmoGeo");u?n.attr("data-dmogeo",u):n.removeAttr("data-dmogeo"),q=s;var h=!d.attr("data-videoformats"),c=a(".captionRightContainer",U);if(o?(c.addClass("panorama"),fe(t)):h?(M.preloadPhoto(d,s),F(d)):(S(),M.preloadVideo(d),x(n,r)),o||c.removeClass("panorama"),O(d),G(d),!l.isTabletAlbumViewer()){var m=a(".mainImg",U);!o&&h?m.length>0&&(m.get(0).onclick=function(){a(".heroNav.right",U).click()}):m.prop("onclick",null)}H(d),K.tracking.recordImpressionIfDmo()}function D(e){if(0==e.length)return i.record(null,"Photoviewer: tried to extract the panorama id from an empty string."),0;if("p"!=e[0])return i.record(null,"Photoviewer: first character of panorama id string '"+e+"' is not 'p'"),0;var t=e.substring(1),a=parseInt(t,10);return isNaN(a)?(i.record(null,"Photoviewer: could not convert pano id "+t+" to an integer"),0):a}function R(e,t){if(e=a(e),e.length){t=a(t);var r=e.width()/e.height()>t.width()/t.height();t.toggleClass("portrait",!r).toggleClass("landscape",r)}}function x(e,t){var r=function(e){i.record(null,"albumViewer.js - Cannot play video. "+e)},o=a(".videoPlayer",U);if(!a(".jwPlayer",U).length||!o.length)return r("Player objects not defined.");if(!p)return a(".videoError",U).show(),r("JwPlayer is not loaded.");o.show();var l=o.attr("data-icaption");l&&n.store("jwplayerHelper.video.author.icaption",l);var d=function(){var e=a("#JWPLAYER_wrapper, #JWPLAYER",o)[0];e&&K.afterImgLoad(e,a(".heroPhoto .mainImg",U)),he.getPlayer().on("complete",K.onVideoComplete),he.getPlayer().on("mute",s)},s=function(e){try{sessionStorage.setItem("photoviewer.mute",e.mute.toString())}catch(e){i.record(e)}},u=function(){try{return"true"===sessionStorage.getItem("photoviewer.mute")}catch(e){return i.record(e),!1}},h=function(){a(".videoPlayer",U).hide(),a(".heroPhoto",U).show()};ne=e.attr("data-mediaid");var c=JSON.parse(o.attr("data-videoFormats"));1!==c.length||".flv"!==c[0]||p.hasRequiredFlashPlayer()||i.record("Photoviewer: Video with media id "+ne+" has no usable video formats because user does not have flash","_initVideoPlayer",null,null,"WARN"),he=p.createPlayer({containerId:"JWPLAYER",width:"100%",aspectratio:"4:3",videoUrl:o.attr("data-src"),previewUrl:o.attr("data-preview"),mediaId:ne,locationId:oe,videoFormats:c,isLocationPhotoAlbum:!0,autostart:t||o.attr("data-autostart"),mute:u(),readyCallback:d,initFailureCallback:h,setupErrorCallback:h,disableAds:n.retrieve("ads.isSponsoredGeo")===!0})}function B(){setTimeout(K.onResize.bind(K),400),K.tablet.updateHiddenHeroPhotos()}function N(e){K.loadData(e)}function W(e){a(".navBar",U).replaceWith(a(".navBar",e)),a(".photoRegion",U).replaceWith(a(".photoRegion",e)),a(".upperSidebarContainer",U).replaceWith(a(".upperSidebarContainer",e)),a(".dynamicLowerSidebarContent",U).replaceWith(a(".dynamicLowerSidebarContent",e))}function F(e){var t="rating-"+e.attr("data-rating"),r=a(".reviewContent .bubbles."+t,U);a(".reviewContent .bubbles.shown",U).removeClass("shown"),e.attr("data-rating")>0&&r.addClass("shown")}function O(e){var t,r=e.attr("data-media-filter"),o=a(".logoCircle.management",U),i=a(".logoCircle.tripadvisor",U),n=a(".logoCircle.memberAvatar",U),l=o.add(i).add(n);if(r==Z)t=o;else if(r==ee)t=i;else if(r==$){var d=e.attr("data-avatarurl");a(".circularAvatarImg",n).attr("src",d),t=n}l.not(t).hide(),t.show()}function G(e){var t,r=e.attr("data-reviewurl")||null,o=e.attr("data-captiontext")||e.attr("data-icaption")||"",i=a(".captionArea .captionTitle",U);o=o.replace(/[\r\n]/g,""),r?(t=a("<a></a>").html(o),t.prop({href:r})):t=o,i.html(t);var n=e.attr("data-captionprovider"),l=a(".captionArea .captionProvider",U);n?l.html(n):l.empty()}function _(){var e=c.getTimeSincePhotoviewerFirstOpened();e&&"images"==y()&&e<=ae&&(X=setTimeout(J,re))}function J(){var e=5,t=a(".photoGridImg img",U),r=a(".photoGridImg.smallLoading",U).length,o=0;t.each(function(e,t){t.complete&&o++}),0===o&&t.length>=e?i.record(null,"Photoviewer images were slow to load in placement photoviewer",null,{numGridImages:t.length,numSpinnersShowing:r}):r===t.length&&r>=e&&i.record(null,"Photoviewer spinners took too long in placement photoviewer",null,{numSpinnersShowing:r})}function j(){return se==te}var M,q,z,U,Y,Q,X,K={tracking:v},Z=1,$=2,ee=4,te=14,ae=3e3,re=7e3,oe=0,ie=0,ne=-1,le=!1,de=-1,se=-1,ue=new f.SwitchingTabs,he=null,ce=0,me=u.isRtl(),pe={};K.init=function(e,r,d){if(U=a("#"+t.id),Q=!1,!U.length){var u=arguments;return void s.waitForSelector("#"+t.id,function(){K.init.apply(K,u)},function(e){i.record(null,"Photoviewer init was slow.",null,{failDuration:e,userAgent:navigator.userAgent},"WARN")},3)}_(),K.resetNumHeroPhotosClicked();var p=c.parseFragment();if(p&&(e=p),ne=e.ff||-1,Y=d.krpanoLib,pe.wasHelpful=d.loc_wasThisPhotoHelpful,oe=e.geo,ie=e.detail,se=parseInt(e.aggregationId,10),K.tracking.init(U,parseInt(ie,10),r.trackingPlaceTypeId,y,function(){return q}),K.tracking.recordInitialImpressions(r),K.tracking.recordImpressionIfDmo(),K.tablet=new b.PVTablet(U,y,R,function(){K.tracking.setHeroPhotoSwiped(!0)}),T(),C(),K.refreshDisplay(!0,!0,!1),a(window).on("resize",K.onResize.bind(K)),setTimeout(K.onResize.bind(K),1),a(document).on("keyup",I),o.fireEvent("mediaViewerBeforeViewChange",e.albumViewMode),k(e,"albumViewerPushState"),M=new w.HeroPreloader(U,S,function(){return q},R),"hero"==y()){M.beginPreload(),o.fireEvent("photoLightBoxLoad");var f=a(".heroPhoto",U).attr("data-panorama");f&&fe(f)}o.fireEvent("albumViewerInit"),require.defined("ta/photos/sponsoredVideo")?require("ta/photos/sponsoredVideo").init():n.has("photoAlbumSponsoredVideoJS")&&h.load(n.retrieve("photoAlbumSponsoredVideoJS"),function(){require("ta/photos/sponsoredVideo").init()});var g=a(".heroPhoto.playableVideo",U);g.length&&a(".videoPlayer",g).length&&x(g,!1);var V=a(".triplist-cta",U);V.length&&v.recordTriplistCtaView(),l.isTabletAlbumViewer()&&(K.tablet.init("hero"==y()),a(window).on("orientationchange",B)),o.on("photoviewer.mediaFilterClick",N),m.init(U,ie);var A=function(){o.off("mediaViewerLightboxHide",A),K.cleanup()};o.on("mediaViewerLightboxHide",A),o.on("photoviewer.mediaFiltersToggle",function(){m.checkSidebarAdDisplay(!1)}),P.init(U,K),K.autoplayOverlay=P},K.cleanup=function(){if(!Q){Q=!0,clearTimeout(X);try{K.tracking.recordTimeInLB(),a(window).off("resize",K.onResize),a(document).off("keyup",I),l.isTabletAlbumViewer()&&(a(window).off("orientationchange",B),K.tablet.uninit())}catch(e){}}},K.onResize=function(){if(U.parent("body").length){var e=a(".heroPhoto .mainImg img",U);if(e.length){var t=a("img",e);t.length&&K.afterImgLoad(t,e)}}},K.onVideoComplete=function(){"complete"===he.getState()&&P.openOverlay(ne)},K.refreshDisplay=function(e,t,r){t&&o.fireEvent("mediaViewerCheckAdRefresh",r),e&&this.onResize();var i=a(".heroPhoto",U);i.length&&(this.helpful.update(ne),j()?m.updateCurrentThumb(ne):this.scrollThumbs("current",e)),P.closeOverlay(),m.update()},K.showFlagVote=function(e){var t=a("#reportIAP");if(t){var r=window.event;try{require(["pages/inappropriate_vote_stub"],function(a){a.open(r,t.get(0),{voteContentType:"MEDIA",contentId:e,detailId:ie,geoId:oe,direction:"center"})})}catch(t){i.record(t,"albumViewer:showFlagVote failed",null,{mediaId:e})}}},K.showFlagVoteOfCurrHero=function(){var e=a(".heroPhoto",U).attr("data-mediaid");e&&K.showFlagVote(e)},K.loadData=function(t,n,s,u){function h(){function e(e){var a=null;e&&(a=e.status),le=!1,P<2?(P++,setTimeout(h.bind(window),500)):i.record(null,"albumViewer:loadData",null,{"status":a,"params":t}),U.removeClass("wait"),clearTimeout(V)}function o(e){le=!1,clearTimeout(X);var o=a(e.replace(/<script.+?<\/script>/g,""));if(o.length>0){if("hero"==p)L(o,f);else if("images"==p)W(o),ne=-1,l.isTabletAlbumViewer()&&K.tablet.addScrollableAreaEventHandler(),K.tracking.recordImagesView(se,parseInt(g,10),parseInt(v,10));else if("imageThumbs"==p){var i=a(".inAlbumGrid .photoGridBox",U);s.moreButton?(i=s.moreButton.parent(),s.moreButton.remove()):a(".photoGridBox .moreImageThumbs",U).remove(),i.length&&i.append(a(".albumGridItem",o),a(".moreImageThumbs",o)),K.tracking.recordGridScroll(a(".albumGridItem .fillSquare",U).length)}else if("heroThumbs"==p){var d=a(".tinyThumb",o),u=a(".photos.inHeroList",U);j()&&(d=a(".sidebarMediaListEntry",o),u=a(".sidebarMediaList",U)),c?u.prepend(d):u.append(d)}"heroThumbs"!=p&&(K.refreshDisplay(w,!0,!0),"hero"==p&&M.beginPreload()),A(p),n&&setTimeout(function(){n()},1)}if("hero"==p&&a(".playableVideo",U).length){var h=a(".heroPhoto",U);a(".videoPlayer",h).length&&x(h,t.autoplay)}"heroThumbs"!=p&&"imageThumbs"!=p&&a(".ui_tooltip").remove(),U.removeClass("wait"),clearTimeout(V),g&&(de=g),T(),C(),r.initWidgets(U[0])}try{d({url:"/LocationPhotoAlbum",data:t,success:o,error:e})}catch(e){i.record(e,"Album gallery - AJAX update failure")}}if(!le){"string"==typeof t&&(t=t.parseQueryString(!1,!1)),S(),s=s||{};var c=s.prepend,m=s.source;se=parseInt(t.aggregationId,10);var p=t.albumViewMode||"images",f=t.panoId||t.image||t.ff,g=t.albumid,v=t.filter,b=y(),w="images"==p||"hero"==p&&"hero"!=b;u||"images"!==p&&"hero"!==p||("images"===p&&"images"===b?k(t,"albumViewerReplaceState"):k(t,"albumViewerPushState")),"hero"==p&&"hero"!=b&&K.resetNumHeroPhotosClicked(),null!=M?M.clear(w):i.record(e,"m_heroPreloader is null in photoviewer:loadData()");var P=0;if("hero"==b&&"hero"==p)ce++,o.fireEvent("heroPhotosClicked",[ce,m]),E(f,t.panoPath,t.autoplay);else{if(t.albumPartialsToUpdate="partial","hero"==p){var I=a(".albumLightbox .heroWrapper .heroPhoto, .albumLightbox .photoRegion");t.heroMinWidth=I.width(),t.heroMinHeight=I.height()}le=!0,U.addClass("wait");var V=setTimeout(function(){U.removeClass("wait")},1e4);ue&&ue.reset(),h()}}},K.next=function(e){K.advanceHero(e,!me)},K.prev=function(e){K.advanceHero(e,me)},K.advanceHero=function(e,t){e=a(e);var r=a(".tinyThumb.current",U);if(e.length&&!e.hasClass("disabled")){var o,i;if(t){var n=a("a",r.next(".tinyThumb"));!n.length&&parseInt(r.attr("data-offset"))>0&&(i=me?"left":"right"),o=n.attr("data-href")}else{var d=a("a",r.prev(".tinyThumb"));!d.length&&parseInt(r.attr("data-offset"))>0&&(i=me?"right":"left"),o=d.attr("data-href")}if(i){var s=new g.ThumbsScroller(K.loadData,U);if(s.init())return void s.loadMore(K.advanceHero.bind(K,e,t),i)}o&&K.loadData(o,null,{source:"arrow"}),l.isTabletAlbumViewer()&&K.tablet.updateHiddenHeroPhotos(),K.tracking.recordArrowClick()}},K.loadMoreImages=function(e){var t=a(e).attr("data-href");K.loadData(t,null,{moreButton:a(e)})},K.scrollThumbs=function(e,t){try{var a=new g.ThumbsScroller(K.loadData,U);a.init()&&a.scroll(e,t)}catch(t){i.record(t,"albumViewer:scrollThumbs failed",null,{direction:e})}},K.afterImgLoad=function(e,t){3==arguments.length&&(e=arguments[1],t=arguments[2]),e=a(e),t=a(t),setTimeout(function(){t.length&&R(e,t);var a=e.add(e.parent()).add(e.parent().parent());a.removeClass("bigLoading smallLoading"),S()},1)},K.afterThumbnailLoad=function(e){2==arguments.length&&(e=arguments[1]),setTimeout(function(){a(e).closest(".smallLoading").removeClass("smallLoading")},1)},K.helpful=function(){var e,t={},r=null;t.update=function(t){e||(e={}),r=t;var i=a("#thumb-"+r,U),n=parseInt(i.attr("data-albumid"),10),l=parseInt(i.attr("data-media-filter"),10),d=parseInt(i.attr("data-media-type"),10),s=parseInt(i.attr("data-helpfulVotes"))||0;a(".thumbsCount",U).text(s).toggleClass("hidden",!s);var u=t in e,h=a(".helpfulButton .innerButton",U);h.off("click"),u||h.css("display","inline-block").on("click",function(){o(5,ie,t,n,l,d);var e=parseInt(i.attr("data-helpfulVotes")||0)+1;i.attr("data-helpfulVotes",e),a(".thumbsCount",U).text(e).removeClass("hidden"),a(".helpfulButton .innerButton",U).off("click")})};var o=function(t,a,r,o,i,n){d({url:"/VideoController",data:{a:"vt",ff:r,vote:t,detail:a,token:window.JS_SECURITY_TOKEN}}),e[r]=!0,K.tracking.recordHelpfulVote(r,o,i,n)};return t}();var fe=function(e){function t(){S(),a("PANO_HOLDER").empty().removeProp("onclick").css({width:"100%",height:"100%",margin:"auto",top:"auto",left:"auto",right:"auto"});var t={html5:"only",wmode:"transparent",xml:"/PanoramaXml?pano="+encodeURIComponent(e),target:"PANO_HOLDER",id:"albumViewerPano"};a(".heroWrapper",U).addClass("panorama"),embedpano(t)}window.embedpano?t():Asset.javascript(Y,{onLoad:t})};return K.resetNumHeroPhotosClicked=function(){ce=0},K})});require(["ta/p13n/placements"],function(a){var t=a.define.bind(a,"photoviewer","preloader",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);t(["lib/jquery-amd","ta/util/Error"],function(a,t){function r(){var a={},t=[],r=null;this.clear=function(){t=[],a={}},this.clearQueue=function(){t=[]},this.getImageByUrl=function(t){return a[t]};var e=function(){r=null,i()},i=function(){if(!r){var i=t.shift();i&&(r=new Image,a[i]=r,r.onload=e,r.onerror=e,r.src=i,r.complete&&e())}};this.addToQueue=function(r){!r||a[r]||t.contains(r)||(t.include(r),setTimeout(i,1))}}function e(e,n,d,l){var u=this,c=new r;e=a(e),this.clear=function(a){a?c.clear():c.clearQueue()},this.preloadPhoto=function(t,r){t=a(t);var i=(a(".heroWrapper",e),a(".heroPhoto",e)),o=a(".mainImg img",i),p=t.attr("data-heroheight"),h=t.attr("data-herowidth"),s=a(c.getImageByUrl(r)||"<img/>"),m=function(){n(),d()==r&&setTimeout(function(){if(o.parent().length){var t=a(".mainImg",i);t.addClass("imgCenterBoth"),l(s,t),o.replaceWith(s),u.beginPreload(),s.off("load")}},1)};s.on("load",m),p&&s.prop("height",parseInt(p)),h&&s.prop("width",parseInt(h)),s.prop("src")||s.prop("src",r),s.prop("complete")&&m.call(s)},this.preloadVideo=function(r){r=a(r);var i=a(".heroPhoto",e),o=r.attr("data-bigurl"),n=r.attr("data-icaption"),d=r.attr("data-srcurl"),l=r.attr("data-videoformats");a(".mainImg img",i).remove();var u=a(".mainImg",i);return u.length?(u.append(a("<div></div>").addClass("videoPlayer").attr({"data-videoFormats":l,"data-src":d,"data-preview":o,"data-icaption":n}).append(a("<div></div>").addClass("jwPlayer").prop("id","JWPLAYER"))),!0):(t.record(null,"video player - video player cannot load"),!1)},this.beginPreload=function(){var t=a(".tinyThumb"),r=t.filter(".current"),e=r.index();if(r.length){var n,d=Math.max(e-i,0),l=Math.min(e+1+o,t.length);for(n=e+1;n<l;n++)c.addToQueue(a(t[n]).attr("data-bigUrl"));for(n=e-1;n>=d;n--)c.addToQueue(a(t[n]).attr("data-bigUrl"))}}}var i=1,o=3;return{HeroPreloader:e}})});require(["ta/p13n/placements"],function(e){var t=e.define.bind(e,"photoviewer","sidebar",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);t(["lib/jquery-amd","ta/Core/TA.Event","ta/util/Error","ta/Core/TA.Store","ta/projects","api-mod","autoplay"],function(e,t,a,i,r,n,o){function s(e,a){m=e,v=a,l(!0);var i=0;t.on("mediaViewerCheckAdRefresh",function(e){e?l(!0):(i++,i>0&&i%A==0&&l(!0))}),d(),t.on(o.AUTOPLAY_EVENT,d)}function d(){var t=e(y,m);t.prop("checked",o.isAutoplayEnabled()).off("change").on("change",function(){o.setAutoplayEnabled(t.prop("checked"))})}function l(t){var a=e(w,m),i=h(a),r=!a.is(":empty"),n=a.is(":visible");i?(!t&&r||c(),r&&!n&&a.show()):r&&n&&a.hide(),!i&&t&&u()}function c(){if(!r.isTabletAlbumViewer()&&i.has("ads.gptEnabled")){var t=e(w,m);ta.common.ads.injectAjaxAds("locationphotoalbum",w,!0),t.show()}}function h(t){var a=e("#LOC_PHOTO_ALBUMS");if(t.length&&a.length){t.css({visibility:"hidden",display:"block"});var i=n.getPosition(t,a);if(t.css({visibility:"visible",display:""}),i&&i.top+g<e(window).height())return!0}return!1}function u(){if(!T){if(a.record("There is not enough space to show the photoviewer sidebar banner ad in photoviewer placement.","_recordLowAdWarning",null,null,"WARN"),window.IS_DEBUG){var t=e(".sidebarAd",m);t.prepend('<div class="alert">Changes to the photo lightbox have pushed the ad too low, contact Sales Dev</div>')}T=!0}}function p(t){var a=e(".lowerSidebarContainer",m);a.on("scroll",function(){var i=e(".sidebarMediaList",a);if(i.height()<a.scrollTop()+a.height()){var r=e(".sidebarMediaList .tinyThumb").last(),n=parseInt(r.attr("data-offset"),10),o=parseInt(i.attr("data-totalThumbs"),10);n<o-1&&b(i,t,n+1)}})}function b(e,t,a){var i=e.attr("data-moreUrl");i=i.replace(/offset=\d+/,"offset="+a),t(i)}function f(t){e(".sidebarMediaList .tinyThumb.current",m).removeClass("current");var a=e(".sidebarMediaList .tinyThumb[data-mediaId="+t+"]",m);a.addClass("current")}var v,m,A=6,g=250,w="#gpt-ad-300x250-locationphotoalbum",y="#AUTOPLAY-SWITCH",T=!1;return{init:s,update:d,checkSidebarAdDisplay:l,initScrollHandlers:p,updateCurrentThumb:f}})});require(["ta/p13n/placements"],function(t){var a=t.define.bind(t,"photoviewer","switchingTabs",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);a(["lib/jquery-amd"],function(t){function a(){var a={},n=null;this.init=function(i,e,c){this.reset(),t(e+"[data-id]",i).each(function(i,e){e=t(e);var r={elt:e,callback:function(){n in a&&a[n].elt.removeClass("current"),t(this).addClass("current"),c&&c(t(this))}};e.on("click",r.callback);var l=e.attr("data-id");e.hasClass("current")&&(n=l),a[l]=r})},this.reset=function(){Object.keys(a).forEach(function(t){a[t].elt.off("click",a[t].callback)}),a={},n=null}}return{SwitchingTabs:a}})});require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"photoviewer","tablet",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);e(["lib/jquery-amd","ta/Core/TA.Record","ta/projects","ta/util/I18N"],function(t,e,o,n){function i(o,n,i,h){function s(){if(!ta.common.tablet||ta.common.tablet.isPortrait()){var o=t("#TABLET_ORIENTATION_CTA_CONTAINER");o.length&&(o.removeClass("hidden").on("click",d),t(window).on("orientationchange",l),e.trackEventOnPage("Photo_LB_Orientation_CTA","impression","cta_shown"))}}function d(){t("#TABLET_ORIENTATION_CTA_CONTAINER").addClass("hidden").off("click",d)}function l(){d(),u(),e.trackEventOnPage("Photo_LB_Orientation_CTA","rotate","screen_rotated")}function u(){t("#TABLET_ORIENTATION_CTA_CONTAINER").off("click",d),t(window).off("orientationchange",l)}function c(){var e=t(".heroWrapper",o),n=t(".heroThumbnails .inHeroList",o);if(e.length&&n.length){g.updateHiddenHeroPhotos();var i,s,d,l,u,c,f=!1;l=t(".leftHeroPhoto",e),u=t(".heroPhoto",e),c=t(".rightHeroPhoto",e);var v=function(t){u.css("left",""),l.addClass("hidden").css("left",-window.innerWidth+"px"),c.addClass("hidden").css("left",window.innerWidth+"px"),t&&g.updateHiddenHeroPhotos(),f=!1};e.off().on({touchstart:function(e){if(e.originalEvent&&(e=e.originalEvent),i=!1,e.touches&&1==e.touches.length){var o=t(e.target),r=u.offset().left;0!=r&&v(!0);var h=o.prop("tagName").toLowerCase();if("img"==h&&o.parent(".mainImg").length||o.hasClass("heroPhoto")){if(e.preventDefault(),e.stopPropagation(),f)return;var g=t(".tinyThumb.current",n);g.prev(".tinyThumb").length&&(a?c.removeClass("hidden"):l.removeClass("hidden")),g.next(".tinyThumb").length&&(a?l.removeClass("hidden"):c.removeClass("hidden")),s=e.touches[0].pageX,d=0,i=!0,f=!0}}},touchmove:function(t){t.originalEvent&&(t=t.originalEvent),t.touches&&1==t.touches.length&&i&&(t.preventDefault(),t.stopPropagation(),d=t.touches[0].pageX-s,l.hasClass("hidden")?d=Math.min(d,300):c.hasClass("hidden")&&(d=Math.max(d,-300)),l.css("left",-window.innerWidth+d+"px"),u.css("left",d+"px"),c.css("left",window.innerWidth+d+"px"))},touchend:function(o){if(o.originalEvent&&(o=o.originalEvent),o.touches){if(!i)return void v(!1);o.preventDefault(),o.stopPropagation();var n=Math.abs(d)>150;if(n){var a=d>0,s=!1,f={};if(a){var g=t(".heroNav.left",e);g.hasClass("disabled")?(f.leftHeroPhoto=-window.innerWidth,f.currHeroPhoto=0,f.rightHeroPhoto=window.innerWidth):(f.leftHeroPhoto=0,f.currHeroPhoto=window.innerWidth,f.rightHeroPhoto=2*window.innerWidth,s=!0)}else{var p=t(".heroNav.right",e);p.hasClass("disabled")?(f.leftHeroPhoto=-window.innerWidth,f.currHeroPhoto=0,f.rightHeroPhoto=window.innerWidth):(f.leftHeroPhoto=2*-window.innerWidth,f.currHeroPhoto=-window.innerWidth,f.rightHeroPhoto=0,s=!0)}l.animate({left:f.leftHeroPhoto},150),u.animate({left:f.currHeroPhoto},150,"swing",function(){if(s){var o=t(a?".heroNav.left":".heroNav.right",e);o.length&&(h(),r=!1,o.trigger("click"))}setTimeout(function(){v(s)},300)}),c.animate({left:f.rightHeroPhoto},150)}else v(!1)}}})}}function f(e,o,n){if(e&&o){var r=t("div.img",o),a=t("img",o);if(r.css({height:"",width:"",top:"",left:"",marginTop:"",marginLeft:""}),n.length){var h=n.attr("data-heroheight"),s=n.attr("data-herowidth");r.css({height:h?h+"px":"",width:s?s+"px":""}),o.addClass("bigLoading"),a.removeProp("style"),a.on("load",function(){setTimeout(function(){i(a,t(".mainImg",e)),o.removeClass("bigLoading")},10)}),a.prop("src",n.attr("data-bigurl")||a.attr("data-defaulturl"));var d=e.width(),l=e.height(),u=o.hasClass("leftHeroPhoto")?-d:d;o.css({left:u+"px",width:d+"px",height:l+"px"})}else a.prop("src",a.attr("data-defaulturl")?a.attr("data-defaulturl"):"/img2/x.gif")}}var g=this;o=t(o),this.init=function(t){s(),t&&this.addSwipingEventHandlers()},this.uninit=function(){u()},this.addScrollableAreaEventHandler=function(){"albums"!=n()&&"images"!=n()||t(".photoGrid",o).off("touchstart touchmove touchend").on("touchstart touchmove touchend",function(t){t.stopPropagation()})},this.addSwipingEventHandlers=function(){ta.common.tablet&&ta.common.tablet.isManualOverlayZoom()||c()},this.updateHiddenHeroPhotos=function(){var e=t(".heroWrapper",o),n=t(".leftHeroPhoto",e),i=t(".heroPhoto",e),r=t(".rightHeroPhoto",e),h=t(".heroThumbnails .inHeroList .tinyThumb.current",o),s=a?h.next(".tinyThumb"):h.prev(".tinyThumb");f(i,n,s);var d=a?h.prev(".tinyThumb"):h.next(".tinyThumb");f(i,r,d)},this.shouldUpdateHiddenHeroPhotos=function(){return!!r||(r=!0,!1)}}var r=!0,a=n.isRtl();return{PVTablet:i}})});require(["ta/p13n/placements"],function(t){var e=t.define.bind(t,"photoviewer","thumbsScroller",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);e(["lib/jquery-amd","api-mod","ta/util/I18N","ta/util/Error"],function(t,e,i,a){function s(s,h){function r(){var e=t(".heroPhoto",h).attr("data-mediaId");return n.children.filter("[data-mediaId="+e+"]").first()}function l(e){e=t(e),t(".tinyThumb.current",h).removeClass("current"),e.addClass("current");var i=t(".heroNav.right",h),a=t(".heroNav.left",h),s=u?i:a,r=u?a:i;s.toggleClass("disabled",0==parseInt(e.attr("data-offset"))),e.next(".tinyThumb").length>0?r.removeClass("disabled"):r.addClass("disabled")}var n={},d={},u=i.isRtl();h=t(h),this.init=function(){if(n={thumbs:t(".photos.inHeroList",h),thumbsParent:t(".heroThumbnails",h),children:t(".photos.inHeroList div",h)},!n.thumbsParent.length||!n.children.length)return!1;n.lastThumb=n.children.last(),n.firstThumb=n.children.first(),d={lastOffset:parseInt(n.lastThumb.attr("data-offset")),firstOffset:parseInt(n.firstThumb.attr("data-offset")),totalThumbs:parseInt(n.thumbsParent.attr("data-totalThumbs")),navWidth:t(".thumbNav.left",h).outerWidth(),oneThumbWidth:n.lastThumb.outerWidth()},d.visibleWidth=n.thumbsParent.width()-2*d.navWidth;var i=n.thumbsParent.offset().left+d.navWidth,a=i+n.thumbsParent.outerWidth()-d.navWidth,s=n.thumbs.offset().left,r=s+n.thumbs.outerWidth();return d.curLeft=parseInt(n.thumbs.css("left"))||0,d.curRight=parseInt(n.thumbs.css("right"))||0,d.maxLeft=e.getPosition(n.lastThumb,n.thumbs).left+d.oneThumbWidth-d.visibleWidth,d.maxRight=n.thumbs.width()-d.visibleWidth,d.hasMore={unloaded:u?{right:d.firstOffset>0,left:d.lastOffset<d.totalThumbs-1}:{right:d.lastOffset<d.totalThumbs-1,left:d.firstOffset>0},loaded:{right:r>a,left:s<i},loadedNextPage:{right:r-d.visibleWidth>a,left:s+d.visibleWidth<i}},!0},this.loadMore=function(t,e){function i(){"left"!=e||u?"right"==e&&u&&n.thumbs.css({left:"auto",right:0}):n.thumbs.css({right:"auto",left:0}),t&&t()}try{var h=parseInt(n.thumbsParent.attr("data-pageSize"));if(d.hasMore.unloaded[e]){var r=0,l=h,o="left"==e?u:!u;o?r=Math.min(d.lastOffset+1,d.totalThumbs-1):(r=Math.max(d.firstOffset-h,0),h>d.firstOffset&&(l=d.firstOffset));var f=n.thumbsParent.attr("data-moreUrl").replace(/offset=\d+/,"offset="+r).replace(/cnt=\d+/,"cnt="+l),b=u?"right":"left";return s(f,i,{prepend:e==b}),"left"!=e||u?"right"==e&&u&&n.thumbs.css({right:"auto",left:d.visibleWidth-d.curRight-n.thumbs.width()-4}):n.thumbs.css({left:"auto",right:d.visibleWidth-d.curLeft-n.thumbs.width()-4}),!0}}catch(t){a.record(t,"albumViewer:scrollThumbs:loadMore failed",null,{direction:e})}return!1};var o=function(t){var i=r();if(i.length>0){var a=n.thumbsParent[0].getBoundingClientRect(),s=i[0].getBoundingClientRect(),h=a.left+d.navWidth,o=a.right-d.navWidth,f=o-h,b=s.right-s.left,c=s.right>o,g=s.left<h,v=!1,p=e.getPosition(i,n.thumbs).left;u&&(p=n.thumbs.width()-p-b),c?(d.hasMore.loadedNextPage.right||t||(v=this.loadMore(m.bind(this,"current",!0),u?"left":"right")),v||(u?n.thumbs.css("right",Math.min(-p+f-b,0)+"px"):n.thumbs.css("left",Math.max(-p,-d.maxLeft)+"px"))):g&&(d.hasMore.loadedNextPage.left||t||(v=this.loadMore(m.bind(this,"current",!0),u?"right":"left")),v||(u?n.thumbs.css("right",Math.max(-p,-d.maxRight)+"px"):n.thumbs.css("left",Math.min(-p+f-b,0)+"px"))),l(i)}}.bind(this),f=function(t,e){var i=!1;if(d.hasMore.loadedNextPage[t]||e||(i=this.loadMore(m.bind(this,t,!0),t)),!i&&d.hasMore.loaded[t]){var a,s=u?"right":"left";a="right"==t?u?Math.min(d.curRight+d.visibleWidth,0):Math.max(d.curLeft-d.visibleWidth,-d.maxLeft):u?Math.max(d.curRight-d.visibleWidth,-d.maxRight):Math.min(d.curLeft+d.visibleWidth,0),n.thumbs.css(s,a+"px")}}.bind(this),b=function(){var e=t(".heroThumbnails .thumbNav.left",h),i=t(".heroThumbnails .thumbNav.right",h);if(e.length&&i.length){var a=this;setTimeout(function(){a.init()&&(e.toggleClass("disabled",!d.hasMore.loaded.left&&!d.hasMore.unloaded.left),i.toggleClass("disabled",!d.hasMore.loaded.right&&!d.hasMore.unloaded.right))},350)}}.bind(this);this.scroll=function(t,e){"left"==t||"right"==t?f(t,e):"current"==t&&o(e),b()};var m=function(t,e){this.init()&&this.scroll(t,e)}.bind(this)}return{ThumbsScroller:s}})});require(["ta/p13n/placements"],function(e){var o=e.define.bind(e,"photoviewer","tracking",["autoplay","autoplayOverlay","handlers","preloader","sidebar","switchingTabs","tablet","thumbsScroller","tracking"]);o(["lib/jquery-amd","ta/Core/TA.Record","ta/Core/TA.Event"],function(e,o,r){function i(e){var o=e.albumViewMode,r=e.albumId,i=e.mediaGroupFilter;"images"==o?g.recordImagesView(e.aggregationId,r,i):"hero"==o&&(e.panoHeroId?g.recordPanoHeroView(e.panoHeroId,r,i):g.recordHeroView(e.heroId,r,i,e.mediaType))}function a(e){o.trackEventOnPage(w,f,JSON.stringify(e))}function n(e){o.trackEventOnPage(w,h,JSON.stringify(e))}function t(e){return{images:p,hero:u}[e]}var c,d,v,_,m,l,p="photoviewer_grid_view",u="photoviewer_detail_view",s="photoviewer_pano_view",w="UserTracking",f="impression",h="action",g={};return g.init=function(r,i,a,_,m){c=e(r),d=i,v=a,l=m;var p;p=window.performance&&window.performance.now?function(){return window.performance.now()}:window.performance&&window.performance.webkitNow?function(){return window.performance.webkitNow()}:function(){return(new Date).getTime()};var u=p();g.recordTimeInLB=function(){var e=p(),r=e-u,i=Math.round(r),a="photoviewer_close";o.trackEventOnPage(t(_()),a,i,d);var c={event_name:a,location_id:d,photoviewer_view_mode:_(),photoviewer_time_open:i};n(c)}},g.setHeroPhotoClicked=function(e){_=e},g.setHeroPhotoSwiped=function(e){m=e},g.recordImpressionIfDmo=function(){var r=e(".heroPhoto",c),i=r.attr("data-dmogeo"),n=r.attr("data-mediaid");if(i&&n){var t=r.hasClass("playableVideo")?"video":"photo";o.trackEventOnPage("DmoImpr_"+t,i,n,d);var v={event_name:"photoviewer_dmo_"+t,location_id:d,media_id:n};a(v)}},g.recordTriplistCtaView=function(){var e="has_featured_guide";o.trackEventOnPage(e,v,"",d);var r={event_name:"photoviewer_"+e,location_id:d};a(r)},g.recordArrowClick=function(){var e="photo_scroll";_?(_=!1,e+="_tap"):m&&(m=!1,e+="_swipe"),r.fireEvent("galNavClick")},g.recordFilmstripThumbClick=function(){var e="filmstrip_click";o.trackEventOnPage(u,e,"",d);var i={event_name:"photoviewer_"+e,location_id:d};n(i),r.fireEvent("galThumbClick")},g.recordVideoReelClick=function(){var e="video_reel_click";o.trackEventOnPage(u,e,"",d);var i={event_name:"photoviewer_"+e,location_id:d};n(i),r.fireEvent("galThumbClick")},g.recordInitialImpressions=function(e){i(e),e.hasFavoritePhotos&&g.recordFavoritesImpression(),e.hasDmoMedia&&g.recordDmoMediaImpression(),e.hasRestaurantCommerce&&g.recordRestaurantCommerceImpression()},g.recordImagesView=function(e,r,i){var n=[e,r,i].join("|");o.trackEventOnPage(p,v,n,d);var t={event_name:p,location_id:d,media_aggregation_id:e,media_album_id:r,media_group_filter:i};a(t)},g.recordHeroView=function(e,r,i,n){var t=[e,r,i,n].join("|");o.trackEventOnPage(u,v,t,d);var c={event_name:u,location_id:d,media_id:e,media_album_id:r,media_group_filter:i,media_type:n};a(c)},g.recordPanoHeroView=function(e,r,i){var n=[e,r,i].join("|");o.trackEventOnPage(s,v,n,d);var t={event_name:s,location_id:d,media_pano_id:e,media_album_id:r,media_group_filter:i};a(t)},g.recordGridScroll=function(e){var r="photoviewer_scroll";o.trackEventOnPage(r,v,e,d);var i={event_name:r,location_id:d,photoviewer_num_thumbs_shown:e};n(i)},g.recordFavoritesImpression=function(){var e="has_favorite_photos";o.trackEventOnPage(e,v,"",d);var r={event_name:"photoviewer_"+e,location_id:d};a(r)},g.recordRestaurantCommerceImpression=function(){var e="photoviewer_restaurant_commerce_present";o.trackEventOnPage(e,v,"",d);var r={event_name:e,location_id:d};a(r)},g.recordDmoMediaImpression=function(){var e="has_dmo_media";o.trackEventOnPage(e,v,"",d);var r={event_name:"photoviewer_"+e,location_id:d};a(r)},g.recordHelpfulVote=function(e,r,i,a){var t="helpful_vote",c=[e,r,i,a].join("|");o.trackEventOnPage(u,t,c,d);var v={event_name:"photoviewer_"+t,location_id:d,media_id:e,media_album_id:r,media_group_filter:i,media_type:a};n(v)},g})});require(["ta/prwidgets"],function(e){var t=e.define.bind(e,"common_media_filter","handlers",["handlers"]);t(["widget","vanillajs","ta/Core/TA.Record","ta/Core/TA.Event"],function(e,t,i,l){"use strict";function n(e){l.fireEvent("photoviewer.mediaFilterClick",e)}function a(){s(0,"inline-block"),o(!0),l.fireEvent("photoviewer.mediaFiltersToggle")}function r(e){s(e,"none"),o(!1),l.fireEvent("photoviewer.mediaFiltersToggle")}function s(e,t){for(var i=document.getElementsByClassName("albumFilterTag"),l=e,n=i.length;l<n;l++)i[l].style.display=t}function o(e){var t=document.getElementById("toggleAlbumFiltersText"),i=t.getElementsByClassName("expandFilters")[0],l=t.getElementsByClassName("hideFilters")[0];e?(i.style.display="none",l.style.display="block"):(i.style.display="block",l.style.display="none")}return{handleFilterClick:n,handleExpandedMediaFiltersClick:a,handleHideMediaFiltersClick:r}})});var footprint_id="FC";var TALSO={footprint_id:null,footprint_able:false,footprint:null,init:function(a){this.footprint_id=a;this.flash_is_ready()},flash_is_ready:function(){if(!document.getElementById||!document.getElementById(this.footprint_id)){return}if(!this.get_movie(this.footprint_id)){return}this.footprint_able=this.footprint.f_cookie_able()},is_able:function(){return this.footprint_able},del:function(a){if(!this.is_able()){return}this.footprint.f_delete_cookie(a)},get:function(b){if(!this.is_able()){return""}var a=this.footprint.f_get_cookie(b);return((a=="null"||a=="undefined")?"":a)},set:function(a,b){if(!this.is_able()){return}this.footprint.f_set_cookie(a,b)},get_movie:function(){this.footprint=window[this.footprint_id];if(!this.footprint){this.footprint=document[this.footprint_id]}return((this.footprint)?true:false)},get_with_set:function(c,b){var a=this.get(c);if(a==""){this.set(c,b);a=this.get(c);if(a!=b){throw"Failed to set"}}return a}};function flash_ready(){if(!document.getElementById(footprint_id)){footprint_id="FCIE";window.attachEvent("onbeforeunload",forceFlashUnload)}TALSO.init(footprint_id)}var pluginFound=false;function detectFlash(){pluginFound=detectPlugin("Shockwave","Flash");if(!pluginFound){try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.8");pluginFound=true}catch(a){}}return pluginFound}function detectPlugin(){var c=detectPlugin.arguments;var b=false;if(navigator.plugins&&navigator.plugins.length>0){var a=navigator.plugins.length;for(pluginsArrayCounter=0;pluginsArrayCounter<a;pluginsArrayCounter++){var d=0;for(namesCounter=0;namesCounter<c.length;namesCounter++){if((navigator.plugins[pluginsArrayCounter].name.indexOf(c[namesCounter])>=0)||(navigator.plugins[pluginsArrayCounter].description.indexOf(c[namesCounter])>=0)){d++}}if(d==c.length){b=true;break}}}return b}function forceFlashUnload(){var a=document.all.tags("object");if(a&&a.length){for(var b=a.length-1;0<=b;b--){a[b].removeNode(true)}}}function footprintGetWithSet(b){var a;try{a=TALSO.get_with_set("CookieId",b)}catch(c){a=""}return a}function footprintGet(){var a;try{a=TALSO.get("CookieId")}catch(b){a=""}return a}function attemptInject(a){if(a<=0){return}else{if(document.getElementById("FC")&&window.swfobject){window.swfobject.embedSWF("/TALSO.swf","FC","1","1","8",null,null,{allowScriptAccess:"always",hidden:"true",id:"FC"})}else{setTimeout("attemptInject("+(a-1)+");",100)}}}function initTalso(){if(detectFlash()){if((typeof(talsoLoadedWithAjax)!="undefined")&&talsoLoadedWithAjax){var a=document.createElement("div");a.style.display="none";a.id="FC";document.body.appendChild(a);setTimeout("attemptInject(3);",1)}else{try{var d=document.createElement("div");d.id="talsoDiv";d.style.position="absolute";document.body.appendChild(d);d=document.getElementById("talsoDiv");var c="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0";if(window.location.protocol=="https:"){c="https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"}d.innerHTML='<object width="1" height="1" style="position:absolute"  id="FCIE" type="application/x-shockwave-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"  codebase="'+c+'" >  <embed src="/TALSO.swf" width="1" height="1" hidden=true style="position:absolute" id="FC" allowScriptAccess="always">  </embed>  <param name="allowScriptAccess" value="always" />  <param name="movie" value="/TALSO.swf" />  <param name="hidden" value="false" /></object>'}catch(b){}}}}var manageFootprint=function(){try{document.getElementById("screenWidth").value=screen.width;document.getElementById("screenHeight").value=screen.height;var a=TALSO.get("CookieId");if(a==""){TALSO.set("CookieId",document.getElementById("footprint").value);if(TALSO.get("CookieId")!=document.getElementById("footprint").value){document.getElementById("footprint").value=""}}else{document.getElementById("footprint").value=a}}catch(b){if(document.getElementById("footprint")){document.getElementById("footprint").value=""}}};if((typeof(talsoLoadedWithAjax)!="undefined")&&talsoLoadedWithAjax){initTalso()}else{if(window.addEventListener){window.addEventListener("load",initTalso,false)}else{if(window.attachEvent){window.attachEvent("onload",initTalso)}}};